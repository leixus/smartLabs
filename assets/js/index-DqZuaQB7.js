import{_ as Y}from"./index-BImUwXW6.js";import{_ as z}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";/* empty css             *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                  *//* empty css                     *//* empty css                         *//* empty css                *//* empty css               */import{_ as K,u as W}from"./useHandleData-DKqFm39K.js";import{d as L,bf as X,bg as g,p as i,j as Z,c as I,o as b,b as r,a as ee,u as t,bk as x,w as a,aJ as te,P as oe,E as re,Q as ne,e as w,S as se,F as ae,r as ie,T as le,t as y,i as A,bv as pe,g as me,bG as m,bH as ce,bD as ue}from"./index-Djyl84eR.js";import{F as l}from"./formEnum-CT3LisML.js";import{T as _e}from"./index-BgOfTxXv.js";import{_ as fe}from"./form.vue_vue_type_script_setup_true_lang-hHA-x7Ko.js";import{_ as de}from"./grantResource.vue_vue_type_script_setup_true_lang-Bq6BNHBk.js";import{_ as ge}from"./grantPermission.vue_vue_type_script_setup_true_lang-DL2UUwfc.js";import"./index-BpMzQZqs.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css               *//* empty css                */import"./el-tab-pane-l0sNRNKZ.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 *//* empty css                  */import"./sortable.esm-C83syoBY.js";/* empty css                  *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_OrgSelector_lang-ZOwXKiz2.js";/* empty css                       */import"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DgQCsAK8.js";/* empty css                       *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-BaPcQrZE.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-DO1ZDfLA.js";import"./index.vue_vue_type_script_setup_true_name_SInput_lang-C_fN4iWJ.js";import"./formRules-BdD8zfEi.js";import"./dataScopeSelector-q0xw30Ks.js";/* empty css                 *//* empty css                 */const be={class:"main-box"},we={class:"table-box"},ke=L({name:"sysRole"}),wt=L({...ke,setup(Te){const c=X(),$=c.getDictList(g.ROLE_CATEGORY),U=c.getDictList(g.COMMON_STATUS),E=i(null),u=Z({orgId:0}),k=i(),F=[{type:"selection",fixed:"left",width:50},{prop:"name",label:"角色名称",search:{el:"input"}},{prop:"category",label:"角色分类",enum:$,search:{el:"tree-select"}},{prop:"code",label:"角色编码",search:{el:"input"}},{prop:"status",label:"状态",enum:U,search:{el:"tree-select"}},{prop:"sortCode",label:"排序"},{prop:"createTime",label:"创建时间"},{prop:"operation",label:"操作",width:230,fixed:"right"}],C=i(null);function D(e,o={}){var n;(n=C.value)==null||n.onOpen({opt:e,record:o,successful:_})}async function h(e,o){await W(m.delete,{ids:e},o),_()}function _(){var e,o;(e=k.value)==null||e.refresh(),(o=E.value)==null||o.refresh()}function N(e){k.value.pageable.pageNum=1,e!=""?u.orgId=e:u.orgId=0}let T;(e=>{e.GrantResource="授权资源",e.GrantPermission="授权权限",e.GrantUser="授权用户"})(T||(T={}));function M(e,o){return{row:e,command:o}}const v=i(null),S=i(null),O=i(),R=i(0);function P(e){var o,n;switch(e.command){case"授权用户":R.value=e.row.id,m.ownUser({id:e.row.id}).then(f=>{var d;(d=O.value)==null||d.showSelector(f.data)});break;case"授权资源":(o=v.value)==null||o.onOpen({opt:l.EDIT,record:e.row,successful:_});break;case"授权权限":(n=S.value)==null||n.onOpen({opt:l.EDIT,record:e.row,successful:_});break}}function B(e){const o={id:R.value,grantInfoList:e.map(n=>n.id)};m.grantUser(o)}return(e,o)=>{const n=K,f=me,d=re,G=le,q=se,H=oe,V=te,j=z,J=Y;return b(),I("div",be,[r(_e,{ref_key:"treeFilter",ref:E,label:"name",title:"组织列表","request-api":t(x).tree,"default-value":t(u).orgId,onChange:N},null,8,["request-api","default-value"]),ee("div",we,[r(j,{ref_key:"proTable",ref:k,columns:F,"request-api":t(m).page,"init-param":t(u)},{tableHeader:a(s=>[r(n,{suffix:"角色",onClick:o[0]||(o[0]=p=>D(t(l).ADD))}),r(n,{type:"danger",plain:"",suffix:"角色",opt:t(l).DELETE,disabled:!s.isSelected,onClick:p=>h(s.selectedListIds,"删除所选角色")},null,8,["opt","disabled","onClick"])]),status:a(s=>[s.row.status===t(pe).ENABLE?(b(),A(f,{key:0,type:"success"},{default:a(()=>[w(y(t(c).dictTranslation(t(g).COMMON_STATUS,s.row.status)),1)]),_:2},1024)):(b(),A(f,{key:1,type:"danger"},{default:a(()=>[w(y(t(c).dictTranslation(t(g).COMMON_STATUS,s.row.status)),1)]),_:2},1024))]),operation:a(s=>[r(V,null,{default:a(()=>[r(n,{link:"",opt:t(l).EDIT,onClick:p=>D(t(l).EDIT,s.row)},null,8,["opt","onClick"]),r(n,{link:"",opt:t(l).DELETE,onClick:p=>h([s.row.id],`删除【${s.row.name}】角色`)},null,8,["opt","onClick"]),r(H,{onCommand:P},{dropdown:a(()=>[r(q,null,{default:a(()=>[(b(),I(ae,null,ie(T,(p,Q)=>r(G,{key:Q,command:M(s.row,p)},{default:a(()=>[w(y(p),1)]),_:2},1032,["command"])),64))]),_:2},1024)]),default:a(()=>[r(d,{type:"primary",underline:!1,icon:t(ne)},{default:a(()=>o[1]||(o[1]=[w(" 授权 ")])),_:1},8,["icon"])]),_:2},1024)]),_:2},1024)]),_:1},8,["request-api","init-param"]),r(fe,{ref_key:"formRef",ref:C},null,512),r(de,{ref_key:"grantResourceRef",ref:v},null,512),r(ge,{ref_key:"grantPermissionRef",ref:S},null,512),r(J,{ref_key:"userSelectorRef",ref:O,"org-tree-api":t(x).tree,"position-tree-api":t(ue).tree,"role-tree-api":t(m).tree,"user-selector-api":t(ce).selector,multiple:"",onSuccessful:B},null,8,["org-tree-api","position-tree-api","role-tree-api","user-selector-api"])])])}}});export{wt as default};
