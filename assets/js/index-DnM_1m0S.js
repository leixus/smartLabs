/* empty css             *//* empty css                  *//* empty css                   */import{_ as it}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";/* empty css                       *//* empty css                        *//* empty css               *//* empty css                *//* empty css                  */import{k as lt,l as nt}from"./abnormalWarningResponse-BP-xmal3.js";import{_ as at}from"./WarningDetailDialog.vue_vue_type_script_setup_true_lang-DEO3RlJr.js";/* empty css                 *//* empty css                   *//* empty css                       *//* empty css                 */import{d as ot,p as w,X as _,c as y,o as m,F as B,a as e,b as a,z as rt,w as i,r as A,s as k,u as n,t as o,D as dt,e as r,i as N,g as ut,ak as ct,B as P,bi as pt,ab as vt,V as f,W as x}from"./index-Djyl84eR.js";import{_ as mt}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  */import"./sortable.esm-C83syoBY.js";import"./mock-DhPNTjQr.js";/* empty css                             *//* empty css                */const ft={class:"warning-container"},gt={class:"section-container mb-6"},_t={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},yt={class:"lg:col-span-1"},wt={class:"card-header"},kt={class:"notification-list"},bt=["onClick"],Ct={class:"notification-header"},ht={class:"notification-time"},$t={class:"notification-title"},Tt={class:"notification-device"},Wt={class:"lg:col-span-2"},Bt={class:"card-header"},xt={key:0,class:"detail-content"},Dt={class:"detail-title"},Et={class:"detail-meta"},Rt={class:"meta-item"},Vt={class:"meta-item"},Mt={class:"meta-item"},At={class:"meta-item"},Nt={class:"detail-section"},Pt={class:"detail-section"},Ft={class:"detail-section"},Ht={class:"detail-section"},Lt={class:"contacts"},St={class:"contact-actions"},zt={key:1,class:"empty-detail"},Gt={class:"section-container"},It={class:"grid grid-cols-1 gap-4"},Ut={class:"card-header"},Xt={class:"traffic-light-container"},jt={class:"traffic-light"},qt={class:"count"},Jt={class:"count"},Kt={class:"count"},Ot={class:"warning-table-container aw-card"},Qt={class:"dialog-content"},Yt=ot({__name:"index",setup(Zt){const v=w(lt()),F=[{prop:"time",label:"时间"},{prop:"device",label:"设备/试验"},{prop:"description",label:"预警描述",minWidth:200},{prop:"level",label:"级别",minWidth:100},{prop:"operation",label:"操作"}],g=w(nt()),c=w(null),d=_(()=>c.value!==null?v.value[c.value]:null),b=w("all"),H=_(()=>{if(b.value==="all")return g.value;const s={high:"高级",medium:"中级",low:"低级"};return g.value.filter(t=>t.level===s[b.value])}),D=_(()=>g.value.filter(s=>s.level==="高级").length),E=_(()=>g.value.filter(s=>s.level==="中级").length),R=_(()=>g.value.filter(s=>s.level==="低级").length),L=_(()=>D.value>0),S=_(()=>E.value>0),z=_(()=>R.value>0),G=s=>{switch(s){case"高级":return"danger";case"中级":return"warning";case"低级":return"info";default:return"info"}},T=w(),I=s=>{c.value=s,v.value[s].isRead||(v.value[s].isRead=!0)},U=s=>{var t;(t=T.value)==null||t.show(s,"预警详情","warning")},X=s=>{var u;const t={title:`${s.type||s.level}预警处理指南`,scenario:`适用于${s.description||s.device}的异常情况`,steps:[{title:"初步检查",description:"检查设备基本状态和参数显示"},{title:"数据分析",description:"分析异常数据，确定问题原因"},{title:"采取措施",description:"根据分析结果采取相应的处理措施"},{title:"效果验证",description:"验证处理措施的效果"}],notes:["处理过程中需要做好记录","如果问题无法解决，及时上报主管","确保所有安全措施到位"]};(u=T.value)==null||u.show(t,"处理指南","guide")},j=()=>{v.value=v.value.map(s=>({...s,isRead:!0})),f.success("已将所有通知标记为已读")},q=s=>{switch(s){case"设备故障":return"type-device";case"参数异常":return"type-parameter";case"数据异常":return"type-data";default:return""}},J=s=>{switch(s){case"未处理":return"status-pending";case"处理中":return"status-processing";case"已解决":return"status-resolved";default:return""}},K=s=>{switch(s){case"设备故障":return"danger";case"参数异常":return"warning";case"数据异常":return"info";default:return"info"}},O=s=>{switch(s){case"未处理":return"danger";case"处理中":return"warning";case"已解决":return"success";default:return"info"}},Q=async s=>{try{await x.confirm(`确定要处理该预警吗？
设备/试验：${s.device}
预警描述：${s.description}`,"处理预警",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),f.success("预警处理成功");const t=g.value.findIndex(u=>u.id===s.id);t!==-1&&(g.value[t]={...g.value[t],status:"已处理"})}catch(t){t!=="cancel"&&f.error("处理失败："+t.message)}},V=async s=>{try{await x.confirm(`确定要将该通知标记为已处理吗？
${s.title}`,"标记已处理",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),f.success("已标记为已处理"),c.value!==null&&(v.value[c.value]={...v.value[c.value],status:"已解决"})}catch(t){t!=="cancel"&&f.error("操作失败："+t.message)}},M=async s=>{try{const{value:t}=await x.prompt(`为通知"${s.title}"分配处理人`,"分配处理人",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^.{2,}$/,inputErrorMessage:"处理人姓名不能为空"});if(!t)return;c.value!==null&&(v.value[c.value]={...v.value[c.value],status:"处理中",handler:t})}catch(t){t instanceof Error?f.error("分配失败："+t.message):f.error("分配失败")}},Y=async s=>{try{switch(s.type){case"markAsProcessed":await V(s.notification);break;case"assignHandler":await M(s.notification);break;default:f.warning("未知的处理类型")}}catch(t){f.error("处理失败："+t.message)}},C=w(!1),Z=()=>{C.value=!1};return(s,t)=>{const u=dt,h=rt,W=ut,$=pt,tt=ct,et=it,st=vt;return m(),y(B,null,[e("div",ft,[e("div",gt,[t[21]||(t[21]=e("h3",{class:"section-title"},"报警通知中心",-1)),e("div",_t,[e("div",yt,[a(h,{class:"notification-card"},{header:i(()=>[e("div",wt,[t[6]||(t[6]=e("span",null,"最近通知",-1)),a(u,{type:"primary",onClick:j},{default:i(()=>t[5]||(t[5]=[r("全部标为已读")])),_:1})])]),default:i(()=>[e("div",kt,[(m(!0),y(B,null,A(n(v),(l,p)=>(m(),y("div",{key:p,class:k(["notification-item",{"is-selected":n(c)===p,"is-unread":!l.isRead}]),onClick:te=>I(p)},[e("div",Ct,[e("span",{class:k(["notification-type",q(l.type)])},o(l.type),3),e("span",ht,o(l.time),1)]),e("div",$t,o(l.title),1),e("div",Tt,o(l.device),1),e("div",{class:k(["notification-status",J(l.status)])},o(l.status),3)],10,bt))),128))])]),_:1})]),e("div",Wt,[n(c)!==null?(m(),N(h,{key:0,class:"detail-card"},{header:i(()=>[e("div",Bt,[t[9]||(t[9]=e("span",null,"通知详情",-1)),e("div",null,[a(u,{type:"success",class:"mr-2",onClick:t[0]||(t[0]=l=>V(n(d)))},{default:i(()=>t[7]||(t[7]=[r("标记为已处理")])),_:1}),a(u,{type:"primary",onClick:t[1]||(t[1]=l=>M(n(d)))},{default:i(()=>t[8]||(t[8]=[r("分配处理人")])),_:1})])])]),default:i(()=>[n(d)?(m(),y("div",xt,[e("h4",Dt,o(n(d).title),1),e("div",Et,[e("div",Rt,[t[10]||(t[10]=e("span",{class:"meta-label"},"报警类型：",-1)),a(W,{type:K(n(d).type)},{default:i(()=>[r(o(n(d).type),1)]),_:1},8,["type"])]),e("div",Vt,[t[11]||(t[11]=e("span",{class:"meta-label"},"发生时间：",-1)),e("span",null,o(n(d).time),1)]),e("div",Mt,[t[12]||(t[12]=e("span",{class:"meta-label"},"设备/试验：",-1)),e("span",null,o(n(d).device),1)]),e("div",At,[t[13]||(t[13]=e("span",{class:"meta-label"},"处理状态：",-1)),a(W,{type:O(n(d).status)},{default:i(()=>[r(o(n(d).status),1)]),_:1},8,["type"])])]),e("div",Nt,[t[14]||(t[14]=e("h5",{class:"section-subtitle"},"报警原因",-1)),e("p",null,o(n(d).reason),1)]),e("div",Pt,[t[15]||(t[15]=e("h5",{class:"section-subtitle"},"影响范围",-1)),e("p",null,o(n(d).impact),1)]),e("div",Ft,[t[16]||(t[16]=e("h5",{class:"section-subtitle"},"建议行动",-1)),e("p",null,o(n(d).action),1)]),e("div",Ht,[t[19]||(t[19]=e("h5",{class:"section-subtitle"},"联系人",-1)),e("div",Lt,[(m(!0),y(B,null,A(n(d).contacts,(l,p)=>(m(),y("div",{key:p,class:"contact-item"},[e("span",null,o(l.name)+" ("+o(l.role)+")",1),e("div",St,[a(u,{type:"primary",icon:"Phone"},{default:i(()=>t[17]||(t[17]=[r("电话")])),_:1}),a(u,{type:"success",icon:"ChatDotRound"},{default:i(()=>t[18]||(t[18]=[r("消息")])),_:1})])]))),128))])])])):(m(),y("div",zt,"请选择一条通知查看详情"))]),_:1})):(m(),N(h,{key:1,class:"empty-card"},{default:i(()=>t[20]||(t[20]=[e("div",{class:"empty-detail"},"请选择一条通知查看详情",-1)])),_:1}))])])]),e("div",Gt,[t[33]||(t[33]=e("h3",{class:"section-title"},"预警级别视图",-1)),e("div",It,[a(h,{class:"level-card"},{header:i(()=>[e("div",Ut,[t[26]||(t[26]=e("span",null,"预警级别分布",-1)),e("div",null,[a(tt,{modelValue:n(b),"onUpdate:modelValue":t[2]||(t[2]=l=>P(b)?b.value=l:null)},{default:i(()=>[a($,{value:"all"},{default:i(()=>t[22]||(t[22]=[r("全部")])),_:1}),a($,{value:"low"},{default:i(()=>t[23]||(t[23]=[r("低级")])),_:1}),a($,{value:"medium"},{default:i(()=>t[24]||(t[24]=[r("中级")])),_:1}),a($,{value:"high"},{default:i(()=>t[25]||(t[25]=[r("高级")])),_:1})]),_:1},8,["modelValue"])])])]),default:i(()=>[e("div",Xt,[e("div",jt,[e("div",{class:k(["light red",{active:n(L)}])},[e("div",qt,o(n(D)),1),t[27]||(t[27]=e("div",{class:"label"},"高级预警",-1))],2),e("div",{class:k(["light yellow",{active:n(S)}])},[e("div",Jt,o(n(E)),1),t[28]||(t[28]=e("div",{class:"label"},"中级预警",-1))],2),e("div",{class:k(["light green",{active:n(z)}])},[e("div",Kt,o(n(R)),1),t[29]||(t[29]=e("div",{class:"label"},"低级预警",-1))],2)])]),e("div",Ot,[a(et,{"row-key":"id",columns:F,data:n(H),"tool-button":!1,pagination:!1},{level:i(l=>[a(W,{type:G(l.row.level)},{default:i(()=>[r(o(l.row.level),1)]),_:2},1032,["type"])]),operation:i(l=>[a(u,{type:"primary",link:"",onClick:p=>U(l.row)},{default:i(()=>t[30]||(t[30]=[r("查看")])),_:2},1032,["onClick"]),a(u,{type:"primary",link:"",onClick:p=>Q(l.row)},{default:i(()=>t[31]||(t[31]=[r("处理")])),_:2},1032,["onClick"]),a(u,{type:"info",link:"",onClick:p=>X(l.row)},{default:i(()=>t[32]||(t[32]=[r("指南")])),_:2},1032,["onClick"])]),_:1},8,["data"])])]),_:1})])])]),a(at,{ref_key:"detailDialog",ref:T,onProcess:Y},null,512),a(st,{visible:n(C),"onUpdate:visible":t[4]||(t[4]=l=>P(C)?C.value=l:null),title:"处理预警",width:"500px"},{footer:i(()=>[a(u,{onClick:t[3]||(t[3]=l=>C.value=!1)},{default:i(()=>t[35]||(t[35]=[r("取消")])),_:1}),a(u,{type:"primary",onClick:Z},{default:i(()=>t[36]||(t[36]=[r("确定")])),_:1})]),default:i(()=>{var l,p;return[e("div",Qt,[t[34]||(t[34]=e("p",null,"您确定要处理该预警吗？",-1)),e("p",null,"设备/试验："+o((l=n(d))==null?void 0:l.device),1),e("p",null,"预警描述："+o((p=n(d))==null?void 0:p.description),1)])]}),_:1},8,["visible"])],64)}}}),Ae=mt(Yt,[["__scopeId","data-v-25170514"]]);export{Ae as default};
