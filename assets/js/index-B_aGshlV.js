/* empty css             *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        *//* empty css                  *//* empty css                       *//* empty css                     *//* empty css                  *//* empty css               *//* empty css                  *//* empty css               */import"./el-form-item-l0sNRNKZ.js";import{_ as k}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";import Q from"./index-q7OtQnT6.js";import Z from"./index-DHTecIhg.js";/* empty css                 *//* empty css                   */import{d as R,p as f,X as ee,Y as le,a9 as ae,i as te,o as oe,w as a,b as e,_ as re,u as o,a as b,I as ne,y as se,$ as ue,K as de,L as pe,M as ie,an as me,D as fe,e as i,x as be,am as ge,au as ce,B as _e,a8 as ve,V as U}from"./index-Djyl84eR.js";import{_ as Ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";import"./sortable.esm-C83syoBY.js";/* empty css                  */import"./deviceLifecycle-Dr8H_B-E.js";import"./mock-DhPNTjQr.js";const ye={class:"table-header"},we={class:"table-header"},Se=R({name:"PlanDrawer"}),Ee=R({...Se,props:{modelValue:{type:Boolean,default:!1},type:{type:String,required:!0},title:{type:String,required:!0},rowData:{type:Object,default:()=>null}},emits:["update:modelValue","success"],setup(N,{emit:h}){const y=N,T=h,w=f(),r=f({planNo:"",orderNo:"",planName:"",materialCode:"",sampleNo:"",testItems:[],currentStep:"样品准备",progress:0,planStartTime:"",planEndTime:"",actualStartTime:"",actualEndTime:"",status:"NOT_STARTED",priority:"中",responsiblePerson:"",resourceWarning:!1,resourceWarningEnabled:!1,progressWarningThreshold:0,delayStatus:"正常",remarks:"",equipmentNeeds:[],personnelNeeds:[]}),Y={orderNo:[{required:!0,message:"请输入委托编号",trigger:"blur"}],planName:[{required:!0,message:"请输入计划名称",trigger:"blur"}],materialCode:[{required:!0,message:"请输入物料编码",trigger:"blur"}],sampleNo:[{required:!0,message:"请输入试样编号",trigger:"blur"}],testItems:[{required:!0,message:"请选择检测项目",trigger:"change"}],planStartTime:[{required:!0,message:"请选择计划开始时间",trigger:"change"}],planEndTime:[{required:!0,message:"请选择计划完成时间",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],priority:[{required:!0,message:"请选择优先级",trigger:"change"}],responsiblePerson:[{required:!0,message:"请输入负责人",trigger:"blur"}]},g=ee({get:()=>y.modelValue,set:s=>T("update:modelValue",s)}),I=()=>{y.type==="edit"&&y.rowData&&Object.assign(r.value,y.rowData)},P=async()=>{try{U.success("草稿保存成功")}catch(s){console.error("保存草稿失败:",s),U.error("保存草稿失败")}},M=async()=>{w.value&&await w.value.validate(s=>{s&&(T("success"),E())})},E=()=>{g.value=!1};le(()=>g.value,s=>{var l;s?I():(l=w.value)==null||l.resetFields()});const W=f(),H=[{type:"selection",width:60},{type:"index",label:"序号",width:80},{prop:"deviceCode",label:"设备编号",width:150},{prop:"deviceName",label:"设备名称",width:150},{prop:"deviceStatus",label:"设备状态",width:100,enum:[{label:"正常",value:"正常"},{label:"维修中",value:"维修中"},{label:"报废",value:"报废"},{label:"闲置",value:"闲置"}]},{prop:"runningStatus",label:"运行状态",width:100,enum:[{label:"运行中",value:"运行中"},{label:"停用",value:"停用"},{label:"待机",value:"待机"}]},{prop:"specification",label:"规格型号",width:120},{prop:"accuracyRequirement",label:"精度要求",width:120},{prop:"quantity",label:"数量（台/套）",width:140},{prop:"manufacturer",label:"制造厂商",width:150},{prop:"storageLocation",label:"存放地点",width:150},{prop:"responsiblePerson",label:"设备责任人",width:120},{prop:"assetNumber",label:"资产编号",width:120},{prop:"supplierPhone",label:"供货商联系电话",width:150},{prop:"remarks",label:"备注",width:200},{prop:"operation",label:"操作",width:150,fixed:"right"}],c=f([{id:"540000201108192400",deviceCode:"DEV_00000001",deviceName:"或石江性八空设备",deviceStatus:"报废",runningStatus:"运行中",specification:"LD-438",testRange:"276.38~1675.68",accuracyRequirement:"±1.55",factoryNumber:"FN_72067353",quantity:2,manufacturer:"条收命极号验公司",purchasePrice:931182.04,purchaseDate:"2005-12-13",traceabilityMethod:"自校准",traceabilityUnit:"具斯军会没越水从计量院",traceabilityCycle:"20个月",nextTraceDate:"1985-03-08",certificateNumber:"CERT_3574536478",storageLocation:"盘锦市实验室",responsiblePerson:"赵军",department:"同性只相感部",classification:"A类",isImported:"否",assetNumber:"ASSET_90046698",supplierPhone:"14772394677",remarks:"具候非政传行切应海治可果水论。"}]),C=f(),L=()=>{var s;(s=C.value)==null||s.open()},O=s=>{const l=s.filter(d=>!c.value.some(n=>n.id===d.id));c.value.push(...l)},A=s=>{const l=c.value.findIndex(d=>d.id===s.id);l!==-1&&c.value.splice(l,1)},q=f(),B=[{type:"radio",width:60},{type:"index",label:"序号",width:80},{prop:"userCode",label:"工号",width:120},{prop:"userName",label:"姓名",width:120},{prop:"department",label:"所属部门"},{prop:"position",label:"职位"},{prop:"status",label:"状态",enum:[{label:"在职",value:"在职"},{label:"离职",value:"离职"}]},{prop:"operation",label:"操作",width:150,fixed:"right"}],_=f([{id:1,userCode:"JS001",userName:"张三",department:"检测中心",position:"试验员",status:"在职"},{id:2,userCode:"JS002",userName:"李四",department:"检测中心",position:"试验员",status:"在职"}]),F=()=>{var s;(s=q.value)==null||s.open()},$=s=>{const l=_.value.findIndex(d=>d.id===s.id);l!==-1&&_.value.splice(l,1)},j=s=>{const l=s.filter(d=>!_.value.some(n=>n.id===d.id));_.value.push(...l)};return(s,l)=>{const d=de,n=ue,p=se,v=ne,u=ie,V=pe,S=me,D=ae("plus"),x=be,m=fe,J=ge,z=ce,G=re,K=ve;return oe(),te(K,{modelValue:o(g),"onUpdate:modelValue":l[18]||(l[18]=t=>_e(g)?g.value=t:null),title:N.title,size:"100%","destroy-on-close":"",onClose:E},{footer:a(()=>[e(m,{onClick:E},{default:a(()=>l[29]||(l[29]=[i("取消")])),_:1}),e(m,{type:"info",plain:"",onClick:P},{default:a(()=>l[30]||(l[30]=[i("保存草稿")])),_:1}),e(m,{type:"primary",onClick:M},{default:a(()=>l[31]||(l[31]=[i("确定")])),_:1})]),default:a(()=>[e(G,{ref_key:"formRef",ref:w,model:o(r),rules:Y,"label-width":"120px","label-position":"right"},{default:a(()=>[l[26]||(l[26]=b("div",{class:"form-title"},"基本信息",-1)),e(v,{gutter:20},{default:a(()=>[e(p,{span:8},{default:a(()=>[e(n,{label:"计划编号",prop:"planNo"},{default:a(()=>[e(d,{modelValue:o(r).planNo,"onUpdate:modelValue":l[0]||(l[0]=t=>o(r).planNo=t),placeholder:"系统自动生成",disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"委托编号",prop:"orderNo"},{default:a(()=>[e(d,{modelValue:o(r).orderNo,"onUpdate:modelValue":l[1]||(l[1]=t=>o(r).orderNo=t),placeholder:"请输入委托编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"计划名称",prop:"planName"},{default:a(()=>[e(d,{modelValue:o(r).planName,"onUpdate:modelValue":l[2]||(l[2]=t=>o(r).planName=t),placeholder:"请输入计划名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:20},{default:a(()=>[e(p,{span:8},{default:a(()=>[e(n,{label:"物料编码",prop:"materialCode"},{default:a(()=>[e(d,{modelValue:o(r).materialCode,"onUpdate:modelValue":l[3]||(l[3]=t=>o(r).materialCode=t),placeholder:"请输入物料编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"试样编号",prop:"sampleNo"},{default:a(()=>[e(d,{modelValue:o(r).sampleNo,"onUpdate:modelValue":l[4]||(l[4]=t=>o(r).sampleNo=t),placeholder:"请输入试样编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"检测项目",prop:"testItems"},{default:a(()=>[e(V,{modelValue:o(r).testItems,"onUpdate:modelValue":l[5]||(l[5]=t=>o(r).testItems=t),multiple:"",placeholder:"请选择检测项目"},{default:a(()=>[e(u,{label:"拉伸试验",value:"拉伸试验"}),e(u,{label:"冲击试验",value:"冲击试验"}),e(u,{label:"硬度试验",value:"硬度试验"}),e(u,{label:"疲劳试验",value:"疲劳试验"}),e(u,{label:"弯曲试验",value:"弯曲试验"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:20},{default:a(()=>[e(p,{span:8},{default:a(()=>[e(n,{label:"计划开始时间",prop:"planStartTime"},{default:a(()=>[e(S,{modelValue:o(r).planStartTime,"onUpdate:modelValue":l[6]||(l[6]=t=>o(r).planStartTime=t),type:"datetime",placeholder:"请选择开始时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"计划完成时间",prop:"planEndTime"},{default:a(()=>[e(S,{modelValue:o(r).planEndTime,"onUpdate:modelValue":l[7]||(l[7]=t=>o(r).planEndTime=t),type:"datetime",placeholder:"请选择完成时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"实际开始时间",prop:"actualStartTime"},{default:a(()=>[e(S,{modelValue:o(r).actualStartTime,"onUpdate:modelValue":l[8]||(l[8]=t=>o(r).actualStartTime=t),type:"datetime",placeholder:"请选择实际开始时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:20},{default:a(()=>[e(p,{span:8},{default:a(()=>[e(n,{label:"实际完成时间",prop:"actualEndTime"},{default:a(()=>[e(S,{modelValue:o(r).actualEndTime,"onUpdate:modelValue":l[9]||(l[9]=t=>o(r).actualEndTime=t),type:"datetime",placeholder:"请选择实际完成时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"状态",prop:"status"},{default:a(()=>[e(V,{modelValue:o(r).status,"onUpdate:modelValue":l[10]||(l[10]=t=>o(r).status=t),placeholder:"请选择状态"},{default:a(()=>[e(u,{label:"未开始",value:"NOT_STARTED"}),e(u,{label:"执行中",value:"IN_PROGRESS"}),e(u,{label:"已完成",value:"COMPLETED"}),e(u,{label:"异常",value:"ABNORMAL"}),e(u,{label:"已取消",value:"CANCELLED"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"优先级",prop:"priority"},{default:a(()=>[e(V,{modelValue:o(r).priority,"onUpdate:modelValue":l[11]||(l[11]=t=>o(r).priority=t),placeholder:"请选择优先级"},{default:a(()=>[e(u,{label:"高",value:"高"}),e(u,{label:"中",value:"中"}),e(u,{label:"低",value:"低"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{gutter:20},{default:a(()=>[e(p,{span:8},{default:a(()=>[e(n,{label:"负责人",prop:"responsiblePerson"},{default:a(()=>[e(d,{modelValue:o(r).responsiblePerson,"onUpdate:modelValue":l[12]||(l[12]=t=>o(r).responsiblePerson=t),placeholder:"请输入负责人"},null,8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"资源预警",prop:"resourceWarning"},{default:a(()=>[e(V,{modelValue:o(r).resourceWarning,"onUpdate:modelValue":l[13]||(l[13]=t=>o(r).resourceWarning=t),placeholder:"请选择资源预警状态"},{default:a(()=>[e(u,{label:"是",value:!0}),e(u,{label:"否",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(p,{span:8},{default:a(()=>[e(n,{label:"延误状态",prop:"delayStatus"},{default:a(()=>[e(V,{modelValue:o(r).delayStatus,"onUpdate:modelValue":l[14]||(l[14]=t=>o(r).delayStatus=t),placeholder:"请选择延误状态"},{default:a(()=>[e(u,{label:"正常",value:"正常"}),e(u,{label:"延迟",value:"延迟"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{label:"备注",prop:"remarks"},{default:a(()=>[e(d,{modelValue:o(r).remarks,"onUpdate:modelValue":l[15]||(l[15]=t=>o(r).remarks=t),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1}),l[27]||(l[27]=b("div",{class:"form-title"},"资源分配",-1)),e(n,{label:"设备需求",prop:"equipmentNeeds"},{default:a(()=>[e(k,{ref_key:"equipmentTableRef",ref:W,columns:H,data:o(c),pagination:!1,height:"300px"},{tableHeader:a(()=>[b("div",ye,[e(m,{type:"primary",onClick:L},{default:a(()=>[e(x,null,{default:a(()=>[e(D)]),_:1}),l[19]||(l[19]=i("选择设备 "))]),_:1})])]),operation:a(t=>[e(m,{type:"danger",link:"",onClick:X=>A(t.row)},{default:a(()=>l[20]||(l[20]=[i("删除")])),_:2},1032,["onClick"])]),_:1},8,["data"])]),_:1}),e(n,{label:"人员需求",prop:"personnelNeeds"},{default:a(()=>[e(k,{ref:"userTableRef",columns:B,data:o(_),pagination:!1,height:"300px"},{tableHeader:a(()=>[b("div",we,[e(m,{type:"primary",onClick:F},{default:a(()=>[e(x,null,{default:a(()=>[e(D)]),_:1}),l[21]||(l[21]=i("选择人员 "))]),_:1})])]),operation:a(t=>[e(m,{type:"danger",link:"",onClick:X=>$(t.row)},{default:a(()=>l[22]||(l[22]=[i("删除")])),_:2},1032,["onClick"])]),_:1},8,["data"])]),_:1}),l[28]||(l[28]=b("div",{class:"form-title"},"预警设置",-1)),e(n,{label:"进度预警阈值",prop:"progressWarningThreshold"},{default:a(()=>[e(J,{modelValue:o(r).progressWarningThreshold,"onUpdate:modelValue":l[16]||(l[16]=t=>o(r).progressWarningThreshold=t),min:0,max:100,step:5,style:{width:"180px"}},{suffix:a(()=>l[23]||(l[23]=[i("天")])),_:1},8,["modelValue"]),l[24]||(l[24]=b("div",{class:"text-gray-400 text-sm mt-1 ml-2"},"当实际进度落后计划进度超过该阈值时触发预警",-1))]),_:1}),e(n,{label:"资源预警设置",prop:"resourceWarningEnabled"},{default:a(()=>[e(z,{modelValue:o(r).resourceWarningEnabled,"onUpdate:modelValue":l[17]||(l[17]=t=>o(r).resourceWarningEnabled=t)},null,8,["modelValue"]),l[25]||(l[25]=b("div",{class:"text-gray-400 text-sm mt-1 ml-2"},"启用后将监控设备、人员等资源状态并及时预警",-1))]),_:1})]),_:1},8,["model"]),e(Q,{ref_key:"equipmentSelectorRef",ref:C,onSelect:O},null,512),e(Z,{ref_key:"userSelectorRef",ref:q,onSelect:j},null,512)]),_:1},8,["modelValue","title"])}}}),ll=Ve(Ee,[["__scopeId","data-v-1421328d"]]);export{ll as default};
