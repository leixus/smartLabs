/* empty css             *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                         *//* empty css                *//* empty css                 */import"./el-form-item-l0sNRNKZ.js";/* empty css                       *//* empty css                 *//* empty css                */import{d as G,p as u,j as S,X as K,i as C,o as c,ab as M,u as o,B as O,w as s,a as l,b as t,c as y,Z as h,ah as X,ai as z,x as H,k as J,bU as P,bZ as Q,b_ as W,t as m,_ as Y,$ as ee,ak as te,al as se,e as d,K as oe,bN as le,F as ae,r as ne,bO as ie,D as me,V as re}from"./index-ClSyKtod.js";/* empty css                 *//* empty css                   */import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"audit-container"},de={class:"audit-steps"},pe={class:"device-info"},_e={class:"info-content"},fe={class:"info-item"},ve={class:"value"},ge={class:"info-item"},be={class:"value"},ye={class:"info-item"},Ve={class:"value"},Ee={class:"info-item"},ke={class:"value"},we={key:0,class:"audit-history"},xe={key:0,class:"timeline-comment"},De={class:"dialog-footer"},Se=G({__name:"index",props:{device:{}},emits:["close","success"],setup(B,{emit:I}){const L=B,V=I,p=u(!0),g=u(),b=u(!1),a=S({result:"pass",comment:""}),N=S({result:[{required:!0,message:"请选择审核结果",trigger:"change"}],comment:[{required:!0,message:"请输入审核意见",trigger:"blur"},{min:5,message:"审核意见不能少于5个字符",trigger:"blur"}]}),_=K(()=>L.device||{}),i=u(0),r=u([]),T=async()=>{g.value&&await g.value.validate((k,e)=>{if(k){b.value=!0;try{i.value=1,r.value.push({content:"设备管理员提交审核",timestamp:new Date().toLocaleString(),type:"primary",comment:`审核意见：${a.comment}`}),setTimeout(()=>{i.value=2,r.value.push({content:"部门主管审核",timestamp:new Date().toLocaleString(),type:"success",comment:a.result==="pass"?"审核通过":"审核不通过，退回修改"}),setTimeout(()=>{i.value=3,r.value.push({content:"质量部审核",timestamp:new Date().toLocaleString(),type:"success",comment:a.result==="pass"?"审核通过，确认设备状态":"审核不通过，需重新评估"}),setTimeout(()=>{i.value=4,r.value.push({content:"审核流程完成",timestamp:new Date().toLocaleString(),type:"success",comment:a.result==="pass"?"设备审核全部通过":"设备审核未通过"}),re.success(a.result==="pass"?"审核通过":"审核不通过"),V("success",a)},1e3)},1500)},1500)}finally{b.value=!1}}})},E=()=>{p.value=!1,V("close")};return(k,e)=>{const f=H,v=z,R=X,w=se,F=te,x=ee,U=oe,j=Y,q=ie,Z=le,D=me,$=M;return c(),C($,{modelValue:o(p),"onUpdate:modelValue":e[2]||(e[2]=n=>O(p)?p.value=n:null),title:"设备审核",width:"70%","before-close":E,"destroy-on-close":""},{footer:s(()=>[l("span",De,[t(D,{onClick:E},{default:s(()=>e[11]||(e[11]=[d("取消")])),_:1}),t(D,{type:"primary",onClick:T,loading:o(b)},{default:s(()=>e[12]||(e[12]=[d("确定")])),_:1},8,["loading"])])]),default:s(()=>[l("div",ce,[l("div",de,[t(R,{active:o(i),"finish-status":"success","align-center":""},{default:s(()=>[t(v,{title:"提交申请",description:"设备管理员提交"},{icon:s(()=>[t(f,null,{default:s(()=>[t(o(J))]),_:1})]),_:1}),t(v,{title:"部门审核",description:"部门主管审核"},{icon:s(()=>[t(f,null,{default:s(()=>[t(o(P))]),_:1})]),_:1}),t(v,{title:"质量部审核",description:"质量部审核"},{icon:s(()=>[t(f,null,{default:s(()=>[t(o(Q))]),_:1})]),_:1}),t(v,{title:"完成",description:"审核完成"},{icon:s(()=>[t(f,null,{default:s(()=>[t(o(W))]),_:1})]),_:1})]),_:1},8,["active"])]),l("div",pe,[e[7]||(e[7]=l("div",{class:"info-title"},"设备信息",-1)),l("div",_e,[l("div",fe,[e[3]||(e[3]=l("span",{class:"label"},"设备编号：",-1)),l("span",ve,m(o(_).deviceCode),1)]),l("div",ge,[e[4]||(e[4]=l("span",{class:"label"},"设备名称：",-1)),l("span",be,m(o(_).deviceName),1)]),l("div",ye,[e[5]||(e[5]=l("span",{class:"label"},"规格型号：",-1)),l("span",Ve,m(o(_).specification),1)]),l("div",Ee,[e[6]||(e[6]=l("span",{class:"label"},"使用部门：",-1)),l("span",ke,m(o(_).department),1)])])]),t(j,{ref_key:"formRef",ref:g,model:o(a),rules:o(N),"label-width":"100px"},{default:s(()=>[t(x,{label:"审核结果",prop:"result"},{default:s(()=>[t(F,{modelValue:o(a).result,"onUpdate:modelValue":e[0]||(e[0]=n=>o(a).result=n)},{default:s(()=>[t(w,{label:"pass"},{default:s(()=>e[8]||(e[8]=[d("通过")])),_:1}),t(w,{label:"reject"},{default:s(()=>e[9]||(e[9]=[d("不通过")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(x,{label:"审核意见",prop:"comment"},{default:s(()=>[t(U,{modelValue:o(a).comment,"onUpdate:modelValue":e[1]||(e[1]=n=>o(a).comment=n),type:"textarea",rows:3,placeholder:"请输入审核意见"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),o(i)>0?(c(),y("div",we,[e[10]||(e[10]=l("div",{class:"history-title"},"审核记录",-1)),t(Z,null,{default:s(()=>[(c(!0),y(ae,null,ne(o(r),(n,A)=>(c(),C(q,{key:A,timestamp:n.timestamp,type:n.type},{default:s(()=>[d(m(n.content)+" ",1),n.comment?(c(),y("div",xe,m(n.comment),1)):h("",!0)]),_:2},1032,["timestamp","type"]))),128))]),_:1})])):h("",!0)])]),_:1},8,["modelValue"])}}}),Ge=ue(Se,[["__scopeId","data-v-8ac66541"]]);export{Ge as default};
