/* empty css             *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                *//* empty css                *//* empty css                  *//* empty css                       *//* empty css                 *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";import"./el-form-item-l0sNRNKZ.js";import"./index-C6bx8goA.js";import{d as D,j as q,p as w,q as K,aB as H,c as k,o as E,b as l,w as o,_ as J,$ as Q,K as W,bm as X,ak as Y,al as Z,e as y,D as ee,a as m,z as te,L as le,M as oe,V as u,ae as ie}from"./index-yDSqlga2.js";import{i as se}from"./install-CPD1cr-Y.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"panel-content grid grid-cols-1 lg:grid-cols-2 gap-4"},re={class:"simulation-display h-64 border border-gray-300 rounded p-2"},ue={key:0,class:"h-full"},de={key:1,class:"flex items-center justify-center h-full text-gray-500"},me={class:"mt-2 flex justify-between"},pe=D({__name:"index",setup(fe,{expose:L}){const i=q({taskId:"",priority:5,urgency:"medium"}),I=()=>{if(!i.taskId){u.warning("请输入任务ID");return}u.success(`已更新任务 ${i.taskId} 的优先级为 ${i.priority}`),n.value&&M()},V=w();let t=null;const n=w(!1),f=w("medium");let v=null,_=0;const g=[[100,100],[200,150],[300,100],[400,200],[500,150],[600,250],[700,200]],P=[[100,100],[200,200],[300,250],[400,300],[500,250],[600,300],[700,200]],T=[[100,100],[200,50],[300,100],[400,50],[500,100],[600,150],[700,200]],A=[{x:300,y:100,radius:30},{x:500,y:150,radius:40}],b=w([100,100]);let r=[...g],p=0;const B=()=>{V.value&&(t=se(V.value),F())},F=()=>{if(!t)return;const x={animation:!1,tooltip:{formatter:e=>e.seriesName==="AGV"?`AGV位置: (${e.data[0]}, ${e.data[1]})`:e.seriesName==="障碍物"?`障碍物: (${e.data[0]}, ${e.data[1]})`:""},grid:{top:10,right:10,bottom:10,left:10,containLabel:!0},xAxis:{type:"value",min:0,max:800,splitLine:{show:!1}},yAxis:{type:"value",min:0,max:400,splitLine:{show:!1}},series:[{name:"原始路径",type:"line",data:g,lineStyle:{color:"#909399",width:2,type:"dashed"},symbol:"none"},{name:"当前路径",type:"line",data:r,lineStyle:{color:"#409EFF",width:3},symbol:"none"},{name:"障碍物",type:"scatter",data:A.map(e=>[e.x,e.y]),symbolSize:e=>{const s=A.find(a=>a.x===e[0]&&a.y===e[1]);return s?s.radius*2:20},itemStyle:{color:"rgba(245, 108, 108, 0.7)"}},{name:"AGV",type:"scatter",data:[b.value],symbolSize:20,symbol:"arrow",symbolRotate:0,itemStyle:{color:"#67C23A"}}]};t.setOption(x)},z=()=>{n.value||(n.value=!0,_=0,p=0,b.value=[...g[0]],r=[...g],ie(()=>{B(),O()}),u.success("开始模拟动态路径调整"))},G=()=>{n.value&&(n.value=!1,v&&(clearTimeout(v),v=null),t==null||t.dispose(),t=null,u.info("已重置模拟"))},O=()=>{if(!n.value)return;const x=f.value==="slow"?1e3:f.value==="medium"?500:200;v=window.setTimeout(()=>{if(_++,p<r.length-1){const e=r[p],s=r[p+1],a=Math.atan2(s[1]-e[1],s[0]-e[0])*180/Math.PI;if(b.value=[...s],t){const d=t.getOption().series;d&&d.length>=4&&(d[3].data=[b.value],d[3].symbolRotate=a,t.setOption({series:d}))}p++}if(_===3){if(r=[...P],p=2,u({message:"检测到障碍物，切换到备选路径1",type:"warning"}),t){const s=t.getOption().series;s&&s.length>=4&&(s[1].data=r,t.setOption({series:s}))}}else if(_===7){const e=T.slice(4);if(r=[...P.slice(0,4),...e],p=4,u({message:"检测到第二个障碍物，调整路径",type:"warning"}),t){const a=t.getOption().series;a&&a.length>=4&&(a[1].data=r,t.setOption({series:a}))}}if(p>=r.length-1){u.success("AGV已到达目的地，模拟结束"),n.value=!1;return}O()},x)},M=()=>{!n.value||!t||(i.priority>=8||i.urgency==="high"?(f.value="fast",u.info("任务优先级提高，AGV速度加快")):i.priority>=4||i.urgency==="medium"?(f.value="medium",u.info("任务优先级一般，AGV速度正常")):(f.value="slow",u.info("任务优先级降低，AGV速度减慢")))},R=()=>{t==null||t.resize()};return K(()=>{window.addEventListener("resize",R)}),H(()=>{window.removeEventListener("resize",R),v&&clearTimeout(v),t==null||t.dispose()}),L({priorityForm:i,updatePriority:I,startSimulation:z,resetSimulation:G}),(x,e)=>{const s=W,a=Q,$=X,d=Z,N=Y,h=ee,U=J,C=te,S=oe,j=le;return E(),k("div",ne,[l(C,{class:"h-full"},{header:o(()=>e[4]||(e[4]=[m("div",{class:"card-header"},[m("span",{class:"text-lg font-medium"},"任务优先级设置")],-1)])),default:o(()=>[l(U,{model:i,"label-width":"100px",class:"w-full"},{default:o(()=>[l(a,{label:"任务ID"},{default:o(()=>[l(s,{modelValue:i.taskId,"onUpdate:modelValue":e[0]||(e[0]=c=>i.taskId=c)},null,8,["modelValue"])]),_:1}),l(a,{label:"优先级"},{default:o(()=>[l($,{modelValue:i.priority,"onUpdate:modelValue":e[1]||(e[1]=c=>i.priority=c),min:1,max:10,"show-stops":""},null,8,["modelValue"])]),_:1}),l(a,{label:"紧急程度"},{default:o(()=>[l(N,{modelValue:i.urgency,"onUpdate:modelValue":e[2]||(e[2]=c=>i.urgency=c)},{default:o(()=>[l(d,{value:"low"},{default:o(()=>e[5]||(e[5]=[y("低")])),_:1}),l(d,{value:"medium"},{default:o(()=>e[6]||(e[6]=[y("中")])),_:1}),l(d,{value:"high"},{default:o(()=>e[7]||(e[7]=[y("高")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(a,null,{default:o(()=>[l(h,{type:"primary",onClick:I},{default:o(()=>e[8]||(e[8]=[y("更新优先级")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(C,{class:"h-full"},{header:o(()=>e[9]||(e[9]=[m("div",{class:"card-header"},[m("span",{class:"text-lg font-medium"},"动态调整模拟")],-1)])),default:o(()=>[m("div",re,[n.value?(E(),k("div",ue,[m("div",{ref_key:"simulationChartRef",ref:V,class:"w-full h-full"},null,512)])):(E(),k("div",de,"动态路径调整模拟将在此显示"))]),m("div",me,[m("div",null,[l(h,{type:"success",onClick:z,disabled:n.value},{default:o(()=>e[10]||(e[10]=[y("开始模拟")])),_:1},8,["disabled"]),l(h,{onClick:G,disabled:!n.value},{default:o(()=>e[11]||(e[11]=[y("重置")])),_:1},8,["disabled"])]),m("div",null,[l(j,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=c=>f.value=c),placeholder:"模拟速度",size:"small"},{default:o(()=>[l(S,{label:"慢速",value:"slow"}),l(S,{label:"中速",value:"medium"}),l(S,{label:"快速",value:"fast"})]),_:1},8,["modelValue"])])])]),_:1})])}}}),Re=ae(pe,[["__scopeId","data-v-bc1fd7a4"]]);export{Re as default};
