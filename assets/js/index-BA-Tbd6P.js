/* empty css             *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css                *//* empty css                       *//* empty css                 */import"./el-form-item-l0sNRNKZ.js";/* empty css                 *//* empty css                */import{d as M,p as V,X as R,j as Y,V as y,J as U,i as k,o as i,w as a,a as s,b as r,ah as q,c,F as N,r as h,ai as H,Z as j,t as d,_ as z,$ as G,K as J,ak as K,al as L,e as D,s as O,D as X,ab as Z}from"./index-ClSyKtod.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=M({name:"AuditDialog",props:{visible:{type:Boolean,default:!1},recordData:{type:Object,default:()=>({})}},emits:["update:visible","success"],setup(e,{emit:t}){var b,v,g,f,p,l,u,w,$;const o=V(0),_=V(!1),A=R({get:()=>e.visible,set:C=>{t("update:visible",C)}}),n=Y({opinion:"",result:1}),m=V([]),E=R(()=>m.value.filter((C,I)=>I<o.value)),F=Y([{title:"初审",info:[{label:"报告编号",value:((b=e.recordData)==null?void 0:b.reportNo)||""},{label:"报告名称",value:((v=e.recordData)==null?void 0:v.reportName)||""},{label:"提交时间",value:((g=e.recordData)==null?void 0:g.registrationTime)||""}]},{title:"复审",info:[{label:"报告编号",value:((f=e.recordData)==null?void 0:f.reportNo)||""},{label:"报告名称",value:((p=e.recordData)==null?void 0:p.reportName)||""},{label:"提交时间",value:((l=e.recordData)==null?void 0:l.registrationTime)||""}]},{title:"终审",info:[{label:"报告编号",value:((u=e.recordData)==null?void 0:u.reportNo)||""},{label:"报告名称",value:((w=e.recordData)==null?void 0:w.reportName)||""},{label:"提交时间",value:(($=e.recordData)==null?void 0:$.registrationTime)||""}]}]);return{currentStep:o,auditSteps:F,auditForm:n,completedSteps:m,previousStepsResults:E,submitting:_,dialogVisible:A,handleClosed:()=>{o.value=0,n.opinion="",n.result=1,m.value=[]},prevStep:()=>{o.value>0&&o.value--},nextStep:async()=>{if(!n.opinion.trim()){y.error("请输入审核意见");return}_.value=!0;try{m.value[o.value]={...n,auditor:"当前用户",auditTime:U().format("YYYY-MM-DD HH:mm:ss")},o.value===F.length-1?(y.success("审核提交成功"),t("success"),A.value=!1):(o.value++,n.opinion="",n.result=1)}catch(C){y.error("操作失败，请重试"),console.error(C)}finally{_.value=!1}}}}}),W={class:"audit-dialog-content"},x={class:"step-container"},ee={key:0,class:"step-info"},te={class:"label"},se={class:"value"},le={class:"step-form"},ae={class:"completed-steps"},oe={class:"step-title"},ue={class:"result-item"},ie={class:"value"},re={class:"result-item"},ne={class:"result-item"},de={class:"value"},pe={class:"result-item"},me={class:"value"},ce={class:"step-actions"};function ve(e,t,o,_,A,n){var f;const m=H,E=q,F=J,S=G,B=L,T=K,b=z,v=X,g=Z;return i(),k(g,{modelValue:e.dialogVisible,"onUpdate:modelValue":t[2]||(t[2]=p=>e.dialogVisible=p),title:"审核 - "+((f=e.recordData)==null?void 0:f.reportName),width:"70%","close-on-click-modal":!1,onClosed:e.handleClosed},{default:a(()=>{var p;return[s("div",W,[r(E,{active:e.currentStep,"finish-status":"success",class:"audit-steps"},{default:a(()=>[(i(!0),c(N,null,h(e.auditSteps,(l,u)=>(i(),k(m,{key:u,title:l.title},null,8,["title"]))),128))]),_:1},8,["active"]),s("div",x,[(p=e.auditSteps[e.currentStep])!=null&&p.info?(i(),c("div",ee,[(i(!0),c(N,null,h(e.auditSteps[e.currentStep].info,(l,u)=>(i(),c("div",{key:u,class:"info-item"},[s("span",te,d(l.label)+"：",1),s("span",se,d(l.value),1)]))),128))])):j("",!0),s("div",le,[r(b,{model:e.auditForm,"label-width":"100px"},{default:a(()=>[r(S,{label:"审核意见",prop:"opinion",rules:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},{default:a(()=>[r(F,{modelValue:e.auditForm.opinion,"onUpdate:modelValue":t[0]||(t[0]=l=>e.auditForm.opinion=l),type:"textarea",rows:4,placeholder:"请输入审核意见"},null,8,["modelValue"])]),_:1}),r(S,{label:"审核结果",prop:"result",rules:[{required:!0,message:"请选择审核结果",trigger:"change"}]},{default:a(()=>[r(T,{modelValue:e.auditForm.result,"onUpdate:modelValue":t[1]||(t[1]=l=>e.auditForm.result=l)},{default:a(()=>[r(B,{value:1},{default:a(()=>t[3]||(t[3]=[D("通过")])),_:1}),r(B,{value:0},{default:a(()=>t[4]||(t[4]=[D("不通过")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),s("div",ae,[(i(!0),c(N,null,h(e.previousStepsResults,(l,u)=>(i(),c("div",{key:u,class:"step-result"},[s("div",oe,d(e.auditSteps[u].title)+"结果",1),s("div",ue,[t[5]||(t[5]=s("span",{class:"label"},"审核意见：",-1)),s("span",ie,d(l.opinion),1)]),s("div",re,[t[6]||(t[6]=s("span",{class:"label"},"审核结果：",-1)),s("span",{class:O(["value",l.result?"success":"error"])},d(l.result?"通过":"不通过"),3)]),s("div",ne,[t[7]||(t[7]=s("span",{class:"label"},"审核人：",-1)),s("span",de,d(l.auditor),1)]),s("div",pe,[t[8]||(t[8]=s("span",{class:"label"},"审核时间：",-1)),s("span",me,d(l.auditTime),1)])]))),128))]),s("div",ce,[e.currentStep>0?(i(),k(v,{key:0,onClick:e.prevStep},{default:a(()=>t[9]||(t[9]=[D("上一步")])),_:1},8,["onClick"])):j("",!0),r(v,{type:"primary",onClick:e.nextStep,loading:e.submitting},{default:a(()=>[D(d(e.currentStep===e.auditSteps.length-1?"提交":"下一步"),1)]),_:1},8,["onClick","loading"])])])])]}),_:1},8,["modelValue","title","onClosed"])}const ye=P(Q,[["render",ve],["__scopeId","data-v-27136624"]]);export{ye as default};
