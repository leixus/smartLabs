import{_ as Q}from"./index-C7khZHhV.js";import{_ as K}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-dQS8jH7J.js";/* empty css             *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                  *//* empty css                     *//* empty css                         *//* empty css                *//* empty css               */import{_ as W,u as X}from"./useHandleData-B5JvVrK5.js";import{d as L,bf as Y,bg as v,p as l,j as Z,bt as ee,c as E,o as d,b as r,a as te,u as e,bh as $,w as a,aJ as oe,aH as p,bC as m,P as re,E as ne,Q as ae,e as _,S as ie,T as se,t as w,i as N,bv as le,g as pe,bo as f,bn as me,bp as ce}from"./index-yDSqlga2.js";import{F as c}from"./formEnum-CT3LisML.js";import{T as ue}from"./index-DDYGGslX.js";import{_ as de}from"./form.vue_vue_type_script_setup_true_lang-CBVtKw_6.js";import{_ as _e}from"./grantResource.vue_vue_type_script_setup_true_lang-B3E6uy_A.js";import"./index-BhKoq_Rb.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css               *//* empty css                */import"./el-tab-pane-l0sNRNKZ.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 *//* empty css                  */import"./sortable.esm-C83syoBY.js";/* empty css                  *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DRblrf2T.js";/* empty css                       *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_OrgSelector_lang-BiN7E4y6.js";/* empty css                       */import"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-CMD2z1PW.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-BO5mkfYj.js";import"./index.vue_vue_type_script_setup_true_name_SInput_lang-C8CF6EG3.js";import"./formRules-BdD8zfEi.js";import"./dataScopeSelector-Cr-J-kh9.js";/* empty css                 *//* empty css                 */const fe={class:"main-box"},be={class:"table-box"},we=L({name:"sysRole"}),ft=L({...we,setup(ge){const g=Y(),M=g.getDictList(v.COMMON_STATUS),C=l(null),b=Z({orgId:0}),T=l(),z=[{type:"selection",fixed:"left",width:50},{prop:"name",label:"角色名称",search:{el:"input"}},{prop:"code",label:"角色编码",search:{el:"input"}},{prop:"status",label:"状态",enum:M,search:{el:"tree-select"}},{prop:"sortCode",label:"排序"},{prop:"createTime",label:"创建时间"},{prop:"operation",label:"操作",width:230,fixed:"right"}],D=l(null);function S(t,o={}){var i;(i=D.value)==null||i.onOpen({opt:t,record:o,successful:h})}async function y(t,o){await X(f.delete,{ids:t},o),h()}function h(){var t,o;(t=T.value)==null||t.refresh(),(o=C.value)==null||o.refresh()}function B(t){T.value.pageable.pageNum=1,t!=""?b.orgId=t:b.orgId=0}let R;(t=>{t.GrantResource="授权资源",t.GrantUser="授权用户"})(R||(R={}));function O(t,o){return{row:t,command:o}}const I=l(null),x=l(),U=l(0);function F(t){var o;switch(t.command){case"授权用户":U.value=t.row.id,f.ownUser({id:t.row.id}).then(i=>{var u;(u=x.value)==null||u.showSelector(i.data)});break;case"授权资源":(o=I.value)==null||o.onOpen({opt:c.EDIT,record:t.row,successful:h});break}}function q(t){const o={id:U.value,grantInfoList:t.map(i=>i.id)};f.grantUser(o)}return(t,o)=>{const i=W,u=pe,P=ne,A=se,H=ie,V=re,G=oe,j=K,J=Q,s=ee("auth");return d(),E("div",fe,[r(ue,{ref_key:"treeFilter",ref:C,label:"name",title:"组织列表","show-all":!1,"request-api":e($).tree,"default-value":e(b).orgId,onChange:B},null,8,["request-api","default-value"]),te("div",be,[r(j,{ref_key:"proTable",ref:T,columns:z,"request-api":e(f).page,"init-param":e(b)},{tableHeader:a(n=>[p(r(i,{suffix:"角色",onClick:o[0]||(o[0]=k=>S(e(c).ADD))},null,512),[[s,e(m).add]]),p(r(i,{type:"danger",plain:"",suffix:"角色",opt:e(c).DELETE,disabled:!n.isSelected,onClick:k=>y(n.selectedListIds,"删除所选角色")},null,8,["opt","disabled","onClick"]),[[s,e(m).batchDelete]])]),status:a(n=>[n.row.status===e(le).ENABLE?(d(),N(u,{key:0,type:"success"},{default:a(()=>[_(w(e(g).dictTranslation(e(v).COMMON_STATUS,n.row.status)),1)]),_:2},1024)):(d(),N(u,{key:1,type:"danger"},{default:a(()=>[_(w(e(g).dictTranslation(e(v).COMMON_STATUS,n.row.status)),1)]),_:2},1024))]),operation:a(n=>[r(G,null,{default:a(()=>[p(r(i,{link:"",opt:e(c).EDIT,onClick:k=>S(e(c).EDIT,n.row)},null,8,["opt","onClick"]),[[s,e(m).edit]]),p(r(i,{link:"",opt:e(c).DELETE,onClick:k=>y([n.row.id],`删除【${n.row.name}】角色`)},null,8,["opt","onClick"]),[[s,e(m).delete]]),r(V,{onCommand:F},{dropdown:a(()=>[r(H,null,{default:a(()=>[p((d(),E("div",null,[r(A,{command:O(n.row,"授权资源")},{default:a(()=>[_(w("授权资源"),1)]),_:2},1032,["command"])])),[[s,e(m).grantResource]]),p((d(),E("div",null,[r(A,{command:O(n.row,"授权用户")},{default:a(()=>[_(w("授权用户"),1)]),_:2},1032,["command"])])),[[s,e(m).grantUser]])]),_:2},1024)]),default:a(()=>[r(P,{type:"primary",underline:!1,icon:e(ae)},{default:a(()=>o[1]||(o[1]=[_(" 授权 ")])),_:1},8,["icon"])]),_:2},1024)]),_:2},1024)]),_:1},8,["request-api","init-param"]),r(de,{ref_key:"formRef",ref:D},null,512),r(_e,{ref_key:"grantResourceRef",ref:I},null,512),r(J,{ref_key:"userSelectorRef",ref:x,biz:"","org-tree-api":e($).tree,"position-tree-api":e(ce).tree,"role-tree-api":e(f).tree,"user-selector-api":e(me).selector,multiple:"",onSuccessful:q},null,8,["org-tree-api","position-tree-api","role-tree-api","user-selector-api"])])])}}});export{ft as default};
