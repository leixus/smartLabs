/* empty css             *//* empty css                  *//* empty css                   *//* empty css                  *//* empty css               */import{_ as G}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";import{d as K,X as O,p as s,q as Q,i as u,o as c,w as r,a as l,c as C,Z as y,s as x,u as a,b as n,D as ee,e as v,g as oe,t as g,x as te,ac as ae,ad as ie,B as de,a8 as re,ae as h}from"./index-Djyl84eR.js";import{u as le,b as ne,_ as se,a as ce}from"./style-DPyH3vHA.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                  */import"./sortable.esm-C83syoBY.js";const pe={class:"main-box"},be={class:"process-title"},fe={class:"process-content"},ye={key:0,class:"edge-label"},ge=K({__name:"index",props:{visible:{type:Boolean,default:!1}},emits:["update:visible","close"],setup(_,{emit:W}){const R=_,k=W,p=O({get:()=>R.visible,set:e=>{k("update:visible",e)}}),T=()=>{p.value=!1,k("close")},N=[{type:"selection",width:60,fixed:"left"},{prop:"entrustNo",label:"委托单号",minWidth:130,search:{el:"input"}},{prop:"batchNo",label:"样品编号",minWidth:130,search:{el:"input"}},{prop:"status",label:"当前状态",enum:[{label:"待检验",value:0},{label:"检验中",value:1},{label:"已完成",value:2}]},{prop:"nextProcess",label:"下一工序",minWidth:130},{prop:"operation",label:"操作",width:100,fixed:"right"}],b=s(null),D=e=>{},S=s(0),f=s(!1),P=le(),i=s([]),d=s([]),V=e=>{b.value=e,f.value=!0;const t=B(e.batchNo);F(t,e.status),h(()=>{P.fitView()})},B=e=>e.includes("CJ")?"impact":e.includes("LS")?"tensile":e.includes("YD")?"hardness":"default",F=(e,t)=>{switch(i.value=[],d.value=[],e){case"impact":Y(t);break;case"tensile":E(t);break;case"hardness":$(t);break;default:z(t);break}S.value=t},Y=e=>{i.value=[],d.value=[],h(()=>{i.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"冲击试样加工",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"冲击试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"冲击能量数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"冲击试验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},E=e=>{i.value=[],d.value=[],h(()=>{i.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"拉伸试样加工",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"拉伸试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"强度延伸率数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"拉伸试验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},$=e=>{i.value=[],d.value=[],h(()=>{i.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:250,y:150},data:{label:"硬度试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"3",type:"default",position:{x:250,y:250},data:{label:"硬度数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"硬度试验流程"},{id:"e2-3",source:"2",target:"3",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e3-4",source:"3",target:"4",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},z=e=>{i.value=[],d.value=[],h(()=>{i.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"待分配检验",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"检验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"标准检验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},L=()=>{f.value=!1,b.value=null},I=e=>({0:"warning",1:"primary",2:"success"})[e]||"",J=e=>({0:"待检验",1:"检验中",2:"已完成"})[e]||"",q=async e=>Promise.resolve({code:200,msg:"请求成功",data:[{id:"1",entrustNo:"WT20230001",batchNo:"",status:-1,nextProcess:"",children:[{id:"1-1",entrustNo:"WT20230001",batchNo:"SY20230001-CJ",status:1,nextProcess:"冲击试验"},{id:"1-2",entrustNo:"WT20230001",batchNo:"SY20230001-LS",status:0,nextProcess:"拉伸试验"},{id:"1-3",entrustNo:"WT20230001",batchNo:"SY20230001-YD",status:2,nextProcess:"硬度试验"}]},{id:"2",entrustNo:"WT20230002",batchNo:"",status:-1,nextProcess:"",children:[{id:"2-1",entrustNo:"WT20230002",batchNo:"SY20230002-CJ",status:2,nextProcess:"已完成"}]}]});return Q(()=>{}),(e,t)=>{const H=oe,M=ee,U=te,X=re;return c(),u(X,{modelValue:a(p),"onUpdate:modelValue":t[0]||(t[0]=o=>de(p)?p.value=o:null),title:"历史记录",size:"100%","destroy-on-close":!0,onClose:T},{default:r(()=>[l("div",pe,[l("div",{class:x(["table-box",{"table-expanded":a(f)}])},[n(G,{ref:"proTable",title:"检试验进程列表",indent:20,columns:N,"request-api":q,pagination:!1,"row-key":"id","tree-props":{children:"children"},"default-expand-all":"",onSelectionChange:D},{status:r(o=>[o.row.status>-1?(c(),u(H,{key:0,type:I(o.row.status)},{default:r(()=>[v(g(J(o.row.status)),1)]),_:2},1032,["type"])):y("",!0)]),operation:r(o=>[o.row.batchNo&&o.row.batchNo.startsWith("SY")?(c(),u(M,{key:0,type:"primary",link:"",onClick:w=>V(o.row)},{default:r(()=>t[1]||(t[1]=[v(" 查看 ")])),_:2},1032,["onClick"])):y("",!0)]),_:1},512)],2),a(b)?(c(),C("div",{key:0,class:x(["process-box",{expanded:a(f)}])},[l("div",be,[l("h3",null,g(a(b).batchNo||"")+" 试验流程",1),n(U,{class:"close-icon",onClick:L},{default:r(()=>[n(a(ae))]),_:1})]),l("div",fe,[n(a(ne),{nodes:a(i),edges:a(d),"default-viewport":{x:0,y:0,zoom:1.2},"min-zoom":.2,"max-zoom":4,class:"flow-container","fit-view-on-init":""},{"node-default":r(({data:o})=>[l("div",{class:x(["custom-node",o.nodeClass])},g(o.label),3)]),"edge-default":r(({id:o,sourceNode:w,targetNode:Z,style:j,label:m,...A})=>[n(a(ce),ie({id:o,"source-node":w,"target-node":Z,path:"",style:j,label:m},A),{"edge-label":r(()=>[m?(c(),C("div",ye,g(m),1)):y("",!0)]),_:2},1040,["id","source-node","target-node","style","label"])]),default:r(()=>[n(a(se),{"node-color":o=>o.data.nodeClass.includes("highlight")?"#ffca28":"#fff","node-stroke-color":o=>o.data.nodeClass.includes("secondary")?"#ff0072":"#1a192b","node-stroke-width":1.5,position:"bottom-right",width:160,height:120},null,8,["node-color","node-stroke-color"])]),_:1},8,["nodes","edges"])])],2)):y("",!0)])]),_:1},8,["modelValue"])}}}),Le=he(ge,[["__scopeId","data-v-26d6a929"]]);export{Le as default};
