/* empty css             *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                   *//* empty css                       *//* empty css                     *//* empty css                  */import"./el-form-item-l0sNRNKZ.js";import{d as $,p,Y as b,j as B,c as F,o as N,F as j,b as a,ab as O,w as i,_ as A,$ as K,K as L,a as _,D as P,x as W,u as E,bU as z,bV as G,an as J,am as Q,bW as X,e as V,bm as Z}from"./index-ClSyKtod.js";import{_ as h}from"./index.vue_vue_type_script_setup_true_lang-C4UMcuxF.js";import ee from"./index-ptnJnwnk.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index.vue_vue_type_script_setup_true_name_ProTable_lang-BVglHUD0.js";/* empty css                 *//* empty css                    *//* empty css               *//* empty css                 *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                  */import"./sortable.esm-C83syoBY.js";const ae={class:"flex-row w-full"},le={class:"flex-row w-full"},oe={class:"dialog-footer"},ie=$({__name:"index",props:{visible:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},subtaskData:{type:Object,default:()=>({})},userList:{type:Array,default:()=>[]}},emits:["update:visible","submit","cancel"],setup(D,{emit:q}){const g=D,f=q,c=p(),r=p(g.visible);b(()=>g.visible,l=>{r.value=l}),b(()=>r.value,l=>{f("update:visible",l),l||f("cancel")});const e=B({id:"",description:"",assigneeId:"",equipment:"",timeRange:[],actualTimeRange:[],duration:1,actualDuration:void 0,progress:0,remark:""}),T={description:[{required:!0,message:"请输入子任务描述",trigger:"blur"}],assigneeId:[{required:!0,message:"请选择负责人",trigger:"change"}],timeRange:[{required:!0,message:"请选择时间范围",trigger:"change"}],duration:[{required:!0,message:"请输入所需时间",trigger:"blur"}]};b(()=>g.subtaskData,l=>{l&&Object.keys(l).length>0&&(e.id=l.id||"",e.description=l.description||"",e.assigneeId=l.assigneeId||"",e.equipment=l.equipment||"",e.timeRange=l.timeRange||[],e.actualTimeRange=l.actualTimeRange||[],e.duration=l.duration||1,e.actualDuration=l.actualDuration,e.progress=l.progress||0,e.remark=l.remark||"")},{immediate:!0,deep:!0});const Y=()=>{c.value.validate(l=>{l&&f("submit",{id:e.id,description:e.description,assigneeId:e.assigneeId,equipment:e.equipment,startTime:e.timeRange[0],endTime:e.timeRange[1],actualStartTime:e.actualTimeRange&&e.actualTimeRange[0]?e.actualTimeRange[0]:void 0,actualEndTime:e.actualTimeRange&&e.actualTimeRange[1]?e.actualTimeRange[1]:void 0,duration:e.duration,actualDuration:e.actualDuration,progress:e.progress,remark:e.remark})})},U=()=>{var l;(l=c.value)==null||l.resetFields()},s=p(!1),u=p(!1),v=()=>{s.value=!0},k=()=>{u.value=!0},I=l=>{e.assigneeId=`${l.id} (${l.name})`,s.value=!1},x=l=>{e.equipment=`${l.id} - ${l.name}`,u.value=!1};return(l,t)=>{const m=L,n=K,R=W,d=P,y=J,w=Q,C=X,M=Z,H=A,S=O;return N(),F(j,null,[a(S,{modelValue:r.value,"onUpdate:modelValue":t[10]||(t[10]=o=>r.value=o),title:D.isEdit?"编辑子任务":"添加子任务",width:"50%","destroy-on-close":"",onClosed:U},{footer:i(()=>[_("span",oe,[a(d,{onClick:t[9]||(t[9]=o=>r.value=!1)},{default:i(()=>t[14]||(t[14]=[V("取消")])),_:1}),a(d,{type:"primary",onClick:Y},{default:i(()=>t[15]||(t[15]=[V("确定")])),_:1})])]),default:i(()=>[a(H,{model:e,"label-width":"150px",rules:T,ref_key:"formRef",ref:c},{default:i(()=>[a(n,{label:"子任务描述",prop:"description"},{default:i(()=>[a(m,{modelValue:e.description,"onUpdate:modelValue":t[0]||(t[0]=o=>e.description=o),placeholder:"请输入子任务描述",type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),a(n,{label:"负责人",prop:"assigneeId"},{default:i(()=>[_("div",ae,[a(m,{modelValue:e.assigneeId,"onUpdate:modelValue":t[1]||(t[1]=o=>e.assigneeId=o),placeholder:"请选择负责人",onClick:v,class:"flex-1"},null,8,["modelValue"]),a(d,{type:"primary",onClick:v,class:"w-10"},{default:i(()=>[a(R,null,{default:i(()=>[a(E(z))]),_:1})]),_:1})])]),_:1}),a(n,{label:"使用设备",prop:"equipment"},{default:i(()=>[_("div",le,[a(m,{modelValue:e.equipment,"onUpdate:modelValue":t[2]||(t[2]=o=>e.equipment=o),placeholder:"请输入使用的设备",onClick:k,class:"flex-1"},null,8,["modelValue"]),a(d,{type:"primary",onClick:k,class:"w-10"},{default:i(()=>[a(R,null,{default:i(()=>[a(E(G))]),_:1})]),_:1})])]),_:1}),a(n,{label:"计划时间范围",prop:"timeRange"},{default:i(()=>[a(y,{modelValue:e.timeRange,"onUpdate:modelValue":t[3]||(t[3]=o=>e.timeRange=o),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(n,{label:"计划用时(小时)",prop:"duration"},{default:i(()=>[a(w,{modelValue:e.duration,"onUpdate:modelValue":t[4]||(t[4]=o=>e.duration=o),min:.5,step:.5,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(C,{"content-position":"center"},{default:i(()=>t[13]||(t[13]=[V("实际执行情况")])),_:1}),a(n,{label:"实际时间范围",prop:"actualTimeRange"},{default:i(()=>[a(y,{modelValue:e.actualTimeRange,"onUpdate:modelValue":t[5]||(t[5]=o=>e.actualTimeRange=o),type:"datetimerange","range-separator":"至","start-placeholder":"实际开始时间","end-placeholder":"实际结束时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(n,{label:"实际用时(小时)",prop:"actualDuration"},{default:i(()=>[a(w,{modelValue:e.actualDuration,"onUpdate:modelValue":t[6]||(t[6]=o=>e.actualDuration=o),min:0,step:.5,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(n,{label:"完成进度",prop:"progress"},{default:i(()=>[a(M,{modelValue:e.progress,"onUpdate:modelValue":t[7]||(t[7]=o=>e.progress=o),step:5,"show-input":""},null,8,["modelValue"])]),_:1}),a(n,{label:"备注",prop:"remark"},{default:i(()=>[a(m,{modelValue:e.remark,"onUpdate:modelValue":t[8]||(t[8]=o=>e.remark=o),placeholder:"请输入备注信息",type:"textarea",rows:2},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(h,{visible:s.value,"onUpdate:visible":t[11]||(t[11]=o=>s.value=o),onSelectUser:I},null,8,["visible"]),a(ee,{visible:u.value,"onUpdate:visible":t[12]||(t[12]=o=>u.value=o),onSelectEquipment:x},null,8,["visible"])],64)}}}),He=te(ie,[["__scopeId","data-v-8e2a6a88"]]);export{He as default};
