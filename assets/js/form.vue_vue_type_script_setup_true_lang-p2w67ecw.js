import{_ as G}from"./index-C7khZHhV.js";import{_ as j}from"./index-BhKoq_Rb.js";/* empty css             *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css               *//* empty css                  */import{_ as H}from"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DRblrf2T.js";import{_ as L}from"./index.vue_vue_type_script_setup_true_name_SInput_lang-C8CF6EG3.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-CMD2z1PW.js";import{_ as P}from"./index.vue_vue_type_script_setup_true_name_OrgSelector_lang-BiN7E4y6.js";import{d as z,p as c,bf as Y,bg as I,j as S,c as Z,o as k,b as t,u as r,B as J,w as n,_ as K,i as Q,Z as W,D as X,e as d,g as h,t as ee,bm as oe,aH as re,aI as te,bH as le,bG as se,bD as ne,bk as m}from"./index-yDSqlga2.js";import{F as D}from"./formEnum-CT3LisML.js";import{r as u}from"./formRules-BdD8zfEi.js";const we=z({__name:"form",setup(ae,{expose:w}){const i=c(!1),f=Y(),_=f.getDictList(I.ORG_CATEGORY),b=f.getDictList(I.COMMON_STATUS),e=S({opt:D.ADD,record:{},disabled:!1}),O=S({name:[u("请输入组织名称")],parentId:[u("请选择上级组织")],category:[u("请选择组织类型")],status:[u("请选择状态")]});function U(s){Object.assign(e,s),s.opt==D.ADD&&(e.record.sortCode=99,e.record.category=_[0].value,e.record.status=b[0].value),i.value=!0,s.record.id&&m.detail({id:s.record.id}).then(o=>{e.record=o.data})}const g=c();async function x(){var s;(s=g.value)==null||s.validate(async o=>{o&&await m.submitForm(e.record,e.record.id!=null).then(()=>{e.successful()}).finally(()=>{y()})})}function y(){i.value=!1}const V=c();function A(){var o;const s=e.record.directorInfo?[e.record.directorInfo]:[];(o=V.value)==null||o.showSelector(s)}function E(s){s.length>0&&(e.record.directorId=s[0].id,e.record.directorInfo=s[0])}function R(){e.record.directorId=null,e.record.directorInfo=null}return w({onOpen:U}),(s,o)=>{const F=P,a=M,v=L,C=H,p=X,B=h,T=oe,$=K,N=j,q=G;return k(),Z("div",null,[t(N,{modelValue:r(i),"onUpdate:modelValue":o[6]||(o[6]=l=>J(i)?i.value=l:null),title:`${r(e).opt}组织`,"form-size":"600px"},{footer:n(()=>[t(p,{onClick:y},{default:n(()=>o[8]||(o[8]=[d(" 取消 ")])),_:1}),re(t(p,{type:"primary",onClick:x},{default:n(()=>o[9]||(o[9]=[d(" 确定 ")])),_:1},512),[[te,!r(e).disabled]])]),default:n(()=>[t($,{ref_key:"orgFormRef",ref:g,rules:r(O),disabled:r(e).disabled,model:r(e).record,"hide-required-asterisk":r(e).disabled,"label-width":"auto","label-suffix":" :"},{default:n(()=>[t(a,{label:"上级组织",prop:"parentId"},{default:n(()=>[t(F,{"org-value":r(e).record.parentId,"onUpdate:orgValue":o[0]||(o[0]=l=>r(e).record.parentId=l)},null,8,["org-value"])]),_:1}),t(a,{label:"组织名称",prop:"name"},{default:n(()=>[t(v,{modelValue:r(e).record.name,"onUpdate:modelValue":o[1]||(o[1]=l=>r(e).record.name=l)},null,8,["modelValue"])]),_:1}),t(a,{label:"组织编码",prop:"code"},{default:n(()=>[t(v,{modelValue:r(e).record.code,"onUpdate:modelValue":o[2]||(o[2]=l=>r(e).record.code=l),placeholder:"请填写组织编码,不填则为随机值",clearable:""},null,8,["modelValue"])]),_:1}),t(a,{label:"组织分类",prop:"category"},{default:n(()=>[t(C,{modelValue:r(e).record.category,"onUpdate:modelValue":o[3]||(o[3]=l=>r(e).record.category=l),options:r(_),button:""},null,8,["modelValue","options"])]),_:1}),t(a,{label:"状态",prop:"status"},{default:n(()=>[t(C,{modelValue:r(e).record.status,"onUpdate:modelValue":o[4]||(o[4]=l=>r(e).record.status=l),options:r(b),button:""},null,8,["modelValue","options"])]),_:1}),t(a,{label:"指定主管",prop:"directorId"},{default:n(()=>[t(p,{link:"",type:"primary",onClick:A},{default:n(()=>o[7]||(o[7]=[d("选择")])),_:1}),r(e).record.directorId?(k(),Q(B,{key:0,class:"ml-3px",type:"warning",closable:"",onClose:R},{default:n(()=>{var l;return[d(ee((l=r(e).record.directorInfo)==null?void 0:l.name),1)]}),_:1})):W("",!0)]),_:1}),t(a,{label:"排序",prop:"sortCode"},{default:n(()=>[t(T,{modelValue:r(e).record.sortCode,"onUpdate:modelValue":o[5]||(o[5]=l=>r(e).record.sortCode=l),"show-input":"",min:1},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","disabled","model","hide-required-asterisk"])]),_:1},8,["modelValue","title"]),t(q,{ref_key:"userSelectorRef",ref:V,"org-tree-api":r(m).tree,"position-tree-api":r(ne).tree,"role-tree-api":r(se).tree,"user-selector-api":r(le).selector,onSuccessful:E},null,8,["org-tree-api","position-tree-api","role-tree-api","user-selector-api"])])}}});export{we as _};
