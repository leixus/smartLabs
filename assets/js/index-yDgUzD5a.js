/* empty css             *//* empty css               *//* empty css                  */import{_ as Z}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";import j from"./index-B53V2UR7.js";import{d as _,p as n,q as A,c as x,o as c,a as s,Z as y,b as l,w as a,i as v,D as G,e as k,g as K,t as g,s as u,u as i,ac as O,x as Q,ad as X,B as ee,ae as h}from"./index-Djyl84eR.js";import{u as oe,_ as te,a as ae,b as ie}from"./style-DPyH3vHA.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                  *//* empty css                   *//* empty css                  */import"./sortable.esm-C83syoBY.js";const de={class:"main-box"},le={class:"table-header"},ne={class:"process-title"},se={class:"process-content"},ce={key:0,class:"edge-label"},he=_({name:"checkTestProcess"}),pe=_({...he,setup(be){const W=[{type:"selection",width:60,fixed:"left"},{prop:"entrustNo",label:"委托单号",minWidth:130,search:{el:"input"}},{prop:"batchNo",label:"样品编号",minWidth:130,search:{el:"input"}},{prop:"status",label:"当前状态",enum:[{label:"待检验",value:0},{label:"检验中",value:1},{label:"已完成",value:2}]},{prop:"nextProcess",label:"下一工序",minWidth:130},{prop:"operation",label:"操作",width:100,fixed:"right"}],p=n(null),T=e=>{},R=n(0),b=n(!1),f=n(!1),N=oe(),r=n([]),d=n([]),D=e=>{p.value=e,f.value=!0;const t=P(e.batchNo);S(t,e.status),h(()=>{N.fitView()})},P=e=>e.includes("CJ")?"impact":e.includes("LS")?"tensile":e.includes("YD")?"hardness":"default",S=(e,t)=>{switch(r.value=[],d.value=[],e){case"impact":B(t);break;case"tensile":V(t);break;case"hardness":F(t);break;default:Y(t);break}R.value=t},B=e=>{r.value=[],d.value=[],h(()=>{r.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"冲击试样加工",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"冲击试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"冲击能量数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"冲击试验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},V=e=>{r.value=[],d.value=[],h(()=>{r.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"拉伸试样加工",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"拉伸试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"强度延伸率数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"拉伸试验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},F=e=>{r.value=[],d.value=[],h(()=>{r.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:250,y:150},data:{label:"硬度试验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"3",type:"default",position:{x:250,y:250},data:{label:"硬度数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"硬度试验流程"},{id:"e2-3",source:"2",target:"3",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e3-4",source:"3",target:"4",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},Y=e=>{r.value=[],d.value=[],h(()=>{r.value=[{id:"1",type:"default",position:{x:250,y:50},data:{label:"样品接收",nodeClass:e>=0?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=0?"#ffca28":"white",border:e>=0?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"2",type:"default",position:{x:100,y:150},data:{label:"待分配检验",nodeClass:e>=1?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=1?"#333":"#ff0072"}},{id:"3",type:"default",position:{x:400,y:150},data:{label:"检验",nodeClass:e>=1?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=1?"#ffca28":"white",border:e>=1?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"4",type:"default",position:{x:250,y:250},data:{label:"数据录入",nodeClass:e>=2?"highlight-node":"primary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #1a192b",borderRadius:"3px",color:"#333"}},{id:"5",type:"default",position:{x:400,y:350},data:{label:"报告生成",nodeClass:e>=2?"highlight-node":"secondary-node"},style:{width:180,height:40,backgroundColor:e>=2?"#ffca28":"white",border:e>=2?"none":"1px solid #ff0072",borderRadius:"3px",color:e>=2?"#333":"#ff0072"}}],d.value=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=1?void 0:"5,5"},label:""},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:e===0,style:{stroke:e>=1?"#f6ab6c":"#333",strokeWidth:2},label:"标准检验流程"},{id:"e2-4",source:"2",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#aaa",strokeWidth:2,strokeDasharray:e>=2?void 0:"5,5"},label:""},{id:"e3-4",source:"3",target:"4",type:"smoothstep",animated:e===1,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"数据录入"},{id:"e4-5",source:"4",target:"5",type:"straight",animated:e===2,style:{stroke:e>=2?"#f6ab6c":"#333",strokeWidth:2},label:"生成报告"}]})},$=()=>{f.value=!1,p.value=null},E=e=>({0:"warning",1:"primary",2:"success"})[e]||"",L=e=>({0:"待检验",1:"检验中",2:"已完成"})[e]||"",z=async e=>Promise.resolve({code:200,msg:"请求成功",data:[{id:"1",entrustNo:"WT20230001",batchNo:"",status:-1,nextProcess:"",children:[{id:"1-1",entrustNo:"WT20230001",batchNo:"SY20230001-CJ",status:1,nextProcess:"冲击试验"},{id:"1-2",entrustNo:"WT20230001",batchNo:"SY20230001-LS",status:0,nextProcess:"拉伸试验"},{id:"1-3",entrustNo:"WT20230001",batchNo:"SY20230001-YD",status:2,nextProcess:"硬度试验"}]},{id:"2",entrustNo:"WT20230002",batchNo:"",status:-1,nextProcess:"",children:[{id:"2-1",entrustNo:"WT20230002",batchNo:"SY20230002-CJ",status:2,nextProcess:"已完成"}]}]});A(()=>{});const H=()=>{b.value=!0};return(e,t)=>{const w=G,I=K,J=Q;return c(),x("div",de,[s("div",{class:u(["table-box",{"table-expanded":i(f)}])},[l(Z,{ref:"proTable",title:"检试验进程列表",indent:20,columns:W,"request-api":z,pagination:!1,"row-key":"id","tree-props":{children:"children"},"default-expand-all":"",onSelectionChange:T},{tableHeader:a(()=>[s("div",le,[l(w,{type:"info",onClick:H},{default:a(()=>t[1]||(t[1]=[k("历史记录")])),_:1})])]),status:a(o=>[o.row.status>-1?(c(),v(I,{key:0,type:E(o.row.status)},{default:a(()=>[k(g(L(o.row.status)),1)]),_:2},1032,["type"])):y("",!0)]),operation:a(o=>[o.row.batchNo&&o.row.batchNo.startsWith("SY")?(c(),v(w,{key:0,type:"primary",link:"",onClick:C=>D(o.row)},{default:a(()=>t[2]||(t[2]=[k(" 查看 ")])),_:2},1032,["onClick"])):y("",!0)]),_:1},512)],2),i(p)?(c(),x("div",{key:0,class:u(["process-box",{expanded:i(f)}])},[s("div",ne,[s("h3",null,g(i(p).batchNo||"")+" 试验流程",1),l(J,{class:"close-icon",onClick:$},{default:a(()=>[l(i(O))]),_:1})]),s("div",se,[l(i(ie),{nodes:i(r),edges:i(d),"default-viewport":{x:0,y:0,zoom:1.2},"min-zoom":.2,"max-zoom":4,class:"flow-container","fit-view-on-init":""},{"node-default":a(({data:o})=>[s("div",{class:u(["custom-node",o.nodeClass])},g(o.label),3)]),"edge-default":a(({id:o,sourceNode:C,targetNode:q,style:M,label:m,...U})=>[l(i(ae),X({id:o,"source-node":C,"target-node":q,path:"",style:M,label:m},U),{"edge-label":a(()=>[m?(c(),x("div",ce,g(m),1)):y("",!0)]),_:2},1040,["id","source-node","target-node","style","label"])]),default:a(()=>[l(i(te),{"node-color":o=>o.data.nodeClass.includes("highlight")?"#ffca28":"#fff","node-stroke-color":o=>o.data.nodeClass.includes("secondary")?"#ff0072":"#1a192b","node-stroke-width":1.5,position:"bottom-right",width:160,height:120},null,8,["node-color","node-stroke-color"])]),_:1},8,["nodes","edges"])])],2)):y("",!0),l(j,{visible:i(b),"onUpdate:visible":t[0]||(t[0]=o=>ee(b)?b.value=o:null)},null,8,["visible"])])}}}),Ee=re(pe,[["__scopeId","data-v-10ea9c3f"]]);export{Ee as default};
