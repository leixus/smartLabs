import{_ as K}from"./index-p7S5r6Wl.js";import{_ as Q}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";/* empty css             *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                  *//* empty css                     *//* empty css                         *//* empty css                *//* empty css                  *//* empty css                  */import{_ as W,u as T}from"./useHandleData-DKqFm39K.js";import{d as x,bf as X,bg as Y,p as l,j as Z,c as C,o as I,b as o,a as ee,u as r,bk as L,w as s,aJ as te,P as oe,E as re,Q as ae,e as $,S as ne,F as se,r as le,T as ie,t as pe,au as me,bv as f,aj as ce,bH as m,bG as ue,V as de}from"./index-Djyl84eR.js";import{F as p}from"./formEnum-CT3LisML.js";import{T as fe}from"./index-BgOfTxXv.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_name_sysUserForm_lang-C-cT4ro8.js";import{_ as we}from"./grantResource.vue_vue_type_script_setup_true_lang-Bq6BNHBk.js";import{_ as be}from"./grantPermission.vue_vue_type_script_setup_true_lang-DL2UUwfc.js";import"./index-BpMzQZqs.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css               *//* empty css                 *//* empty css                    *//* empty css               *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 */import"./sortable.esm-C83syoBY.js";/* empty css                */import"./formRules-BdD8zfEi.js";import"./form_basic-V5y8b69M.js";import"./index-BImUwXW6.js";import"./el-tab-pane-l0sNRNKZ.js";import"./index.vue_vue_type_script_setup_true_lang-DRw16LSG.js";import"./index.vue_vue_type_script_setup_true_name_SDatePicker_lang-D5yD5oLq.js";/* empty css                       */import"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DgQCsAK8.js";/* empty css                       *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-BaPcQrZE.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-DO1ZDfLA.js";import"./index.vue_vue_type_script_setup_true_name_SInput_lang-C_fN4iWJ.js";import"./form_more.vue_vue_type_script_setup_true_lang-BY9zWeIf.js";import"./index.vue_vue_type_script_setup_true_name_SSelect_lang-CPJJatrh.js";/* empty css                 */import"./dataScopeSelector-q0xw30Ks.js";/* empty css                 */const ge={class:"main-box"},he={class:"table-box"},ve=x({name:"SysUser"}),yt=x({...ve,setup(Ee){const A=X().getDictList(Y.COMMON_STATUS),h=l(null),_=l(!1),c=Z({orgId:0}),w=l(),N=[{type:"selection",fixed:"left",width:50},{prop:"searchKey",label:"姓名或账号",search:{el:"input"},isShow:!1},{prop:"avatar",label:"头像",width:80},{prop:"account",label:"账号"},{prop:"name",label:"姓名"},{prop:"gender",label:"性别",width:80},{prop:"phone",label:"手机号"},{prop:"orgName",label:"组织"},{prop:"positionName",label:"职位"},{prop:"status",label:"状态",width:90,enum:A,search:{el:"tree-select"}},{prop:"createTime",label:"创建时间"},{prop:"operation",label:"操作",width:230,fixed:"right"}];function O(e){w.value.pageable.pageNum=1,e!=""?c.orgId=e:c.orgId=0}const v=l(null);function E(e,t={}){var a;(a=v.value)==null||a.onOpen({opt:e,record:t,successful:u})}async function k(e,t){await T(m.delete,{ids:e},t),u()}function u(){var e,t;(e=w.value)==null||e.refresh(),(t=h.value)==null||t.refresh()}let b;(e=>{e.ResetPassword="重置密码",e.GrantRole="授权角色",e.GrantResource="授权资源",e.GrantPermission="授权权限"})(b||(b={}));function F(e,t){return{row:e,command:t}}const S=l(),y=l(0),D=l(null),R=l(null);function P(e){var t,a;switch(e.command){case"重置密码":T(m.resetPassword,{id:e.row.id},"重置密码");break;case"授权角色":y.value=e.row.id,m.ownRole({id:e.row.id}).then(g=>{var d;(d=S.value)==null||d.showSelector(g.data)});break;case"授权资源":(t=D.value)==null||t.onOpen({opt:p.EDIT,record:e.row,successful:u});break;case"授权权限":(a=R.value)==null||a.onOpen({opt:p.EDIT,record:e.row,successful:u});break}}function B(e){const t={id:y.value,roleIdList:e.map(a=>a.id)};m.grantRole(t)}function q(e){_.value=!0;const t=e.status===f.ENABLE?f.DISABLE:f.ENABLE;m.updateStatus({id:e.id},t).then(()=>{_.value=!1,de.success("修改成功"),e.status=t})}return(e,t)=>{const a=W,g=ce,d=me,G=re,M=ie,U=ne,V=oe,H=te,j=Q,z=K;return I(),C("div",ge,[o(fe,{ref_key:"treeFilter",ref:h,label:"name",title:"组织列表","request-api":r(L).tree,"default-value":r(c).orgId,onChange:O},null,8,["request-api","default-value"]),ee("div",he,[o(j,{ref_key:"proTable",ref:w,title:"用户列表",columns:N,"request-api":r(m).page,"init-param":r(c)},{tableHeader:s(n=>[o(a,{suffix:"用户",onClick:t[0]||(t[0]=i=>E(r(p).ADD))}),o(a,{type:"danger",plain:"",suffix:"用户",opt:r(p).DELETE,disabled:!n.isSelected,onClick:i=>k(n.selectedListIds,"删除所选用户")},null,8,["opt","disabled","onClick"])]),avatar:s(n=>[o(g,{src:n.row.avatar,size:30},null,8,["src"])]),status:s(n=>[o(d,{"model-value":n.row.status===r(f).ENABLE,loading:r(_),onChange:i=>q(n.row)},null,8,["model-value","loading","onChange"])]),operation:s(n=>[o(H,null,{default:s(()=>[o(a,{link:"",opt:r(p).EDIT,onClick:i=>E(r(p).EDIT,n.row)},null,8,["opt","onClick"]),o(a,{link:"",opt:r(p).DELETE,onClick:i=>k([n.row.id],`删除【${n.row.account}】用户`)},null,8,["opt","onClick"]),o(V,{onCommand:P},{dropdown:s(()=>[o(U,null,{default:s(()=>[(I(),C(se,null,le(b,(i,J)=>o(M,{key:J,command:F(n.row,i)},{default:s(()=>[$(pe(i),1)]),_:2},1032,["command"])),64))]),_:2},1024)]),default:s(()=>[o(G,{type:"primary",underline:!1,icon:r(ae)},{default:s(()=>t[1]||(t[1]=[$(" 更多 ")])),_:1},8,["icon"])]),_:2},1024)]),_:2},1024)]),_:1},8,["request-api","init-param"]),o(_e,{ref_key:"formRef",ref:v},null,512),o(z,{ref_key:"roleSelectorRef",ref:S,multiple:"","org-tree-api":r(L).tree,"role-selector-api":r(ue).roleSelector,onSuccessful:B},null,8,["org-tree-api","role-selector-api"]),o(we,{user:"",ref_key:"grantResourceRef",ref:D},null,512),o(be,{user:"",ref_key:"grantPermissionRef",ref:R},null,512)])])}}});export{yt as default};
