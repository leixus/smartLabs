/* empty css             *//* empty css                */import{_ as j}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-dQS8jH7J.js";/* empty css                    *//* empty css               *//* empty css                  */import O from"./AgvDialog-5Uj86nbK.js";import W from"./AgvDetailDialog-Dph3TXmQ.js";import q from"./MaintenanceRequestDialog-B28up_N-.js";import J from"./AgvHistoryDrawer-DzENB5lh.js";/* empty css                       *//* empty css                 *//* empty css                   *//* empty css                 *//* empty css                   */import{d as K,p as c,c as h,o as m,b as i,z as Z,w as s,u as o,a as b,i as G,Z as Q,D as X,e as u,g as Y,t as _,F as tt,r as et,bI as nt,B as S,W as st,V as f}from"./index-yDSqlga2.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                 *//* empty css                    *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                  */import"./sortable.esm-C83syoBY.js";/* empty css                  *//* empty css                       *//* empty css                        *//* empty css                  *//* empty css                             */const it={class:"panel-content grid grid-cols-1 gap-4"},ot={class:"card-header flex justify-between items-center"},rt={key:0,class:"task-tags-container"},lt={class:"task-tags"},ut={key:1,class:"no-task"},ct={class:"flex justify-start items-center gap-2"},dt=K({__name:"index",setup(pt){const w=[{label:"AGV ID",prop:"id"},{label:"名称",prop:"name"},{label:"关联任务",prop:"task"},{label:"当前位置",prop:"location"},{label:"当前路线",prop:"route"},{label:"设备状态",prop:"status"},{label:"运行状态",prop:"runningStatus"},{label:"电量",prop:"battery",minWidth:100},{label:"操作",prop:"operation",width:280}],r=c([{id:"AGV-001",name:"AGV-001",status:"正常",battery:85,location:"仓库A-3区",lastMaintenance:"2023-11-15",runningHours:120,nextMaintenance:"2025-03-15",route:"A-B-C路线",tasks:[{id:"T001",name:"物料运输",priority:3},{id:"T002",name:"设备配送",priority:1}],runningStatus:"繁忙"},{id:"AGV-002",name:"AGV-002",status:"警告",battery:45,location:"生产线B-2区",lastMaintenance:"2023-10-20",runningHours:210,nextMaintenance:"2025-03-05",route:"D-E-F路线",tasks:[{id:"T003",name:"成品转运",priority:2}],runningStatus:"运行中"},{id:"AGV-003",name:"AGV-003",status:"故障",battery:12,location:"充电站",lastMaintenance:"2023-11-05",runningHours:180,nextMaintenance:"2025-03-10",route:"无",tasks:[],runningStatus:"停止"},{id:"AGV-004",name:"AGV-004",status:"维护中",battery:100,location:"维修车间",lastMaintenance:"2023-11-25",runningHours:50,nextMaintenance:"2025-03-25",route:"无",tasks:[],runningStatus:"停止"}]),g=c(!1),v=c(!1),V=c(null),k=c(!1),C=c(null),A=c(!1),T=c({}),M=c(!1),B=t=>{switch(t){case"正常":return"success";case"警告":return"warning";case"故障":return"danger";case"维护中":return"info";default:return"info"}},E=t=>t<20?"exception":t<50?"warning":"success",I=t=>t>=8?"danger":t>=5?"warning":t>=3?"success":"info",H=()=>{v.value=!1,V.value={id:"",name:"",status:"正常",battery:100,location:"仓库A-1区",lastMaintenance:new Date().toISOString().split("T")[0],runningHours:0,nextMaintenance:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],tasks:[]},g.value=!0},$=t=>{v.value=!0,V.value={...t},g.value=!0},z=t=>{st.confirm(`确定要删除AGV ${t.id} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{r.value=r.value.filter(e=>e.id!==t.id),f.success("删除成功")}).catch(()=>{})},F=t=>{if(v.value){const e=r.value.findIndex(a=>a.id===t.id);e!==-1&&(r.value[e]={...t},f.success("AGV信息更新成功"))}else{if(r.value.some(e=>e.id===t.id)){f.error(`AGV ID ${t.id} 已存在`);return}r.value.push({...t}),f.success("AGV添加成功")}},N=t=>{C.value=t,k.value=!0},D=t=>{t?T.value={agvId:t.id,description:`${t.id} 需要维护，当前运行时间 ${t.runningHours} 小时`}:T.value={},A.value=!0},P=t=>{f.success("维护请求已提交")},U=t=>{switch(t){case"空闲":return"info";case"繁忙":return"warning";case"运行中":return"success";case"充电中":return"warning";case"停止":return"danger";default:return"info"}},L=()=>{f.success("AGV状态已更新"),r.value.forEach(t=>{t.battery=Math.max(5,Math.min(100,t.battery+Math.floor(Math.random()*20)-10));const e=["仓库A-1区","仓库A-2区","仓库A-3区","生产线B-1区","生产线B-2区","充电站","维修车间"];if(Math.random()>.7&&(t.location=e[Math.floor(Math.random()*e.length)]),t.battery<15?t.status="警告":t.battery>80&&t.status==="警告"&&(t.status="正常"),t.status==="正常"&&Math.random()>.5){const a=["A-B-C路线","D-E-F路线","G-H-I路线","J-K-L路线"];t.route=a[Math.floor(Math.random()*a.length)]}else(t.status==="故障"||t.status==="维护中")&&(t.route="无");if(t.status==="正常"){const a=[{id:"T001",name:"物料运输",priority:3},{id:"T002",name:"成品转运",priority:2},{id:"T003",name:"设备配送",priority:1},{id:"T004",name:"巡检任务",priority:2},{id:"T005",name:"原料采集",priority:3},{id:"T006",name:"废料处理",priority:1}];if(Math.random()>.3){const y=Math.floor(Math.random()*3)+1;t.tasks=[];const p=new Set;for(;p.size<y&&p.size<a.length;){const l=Math.floor(Math.random()*a.length);p.has(l)||(p.add(l),t.tasks.push({...a[l]}))}const x=t.tasks.some(l=>l.priority===3);if(t.tasks.length>1||x)t.runningStatus="繁忙";else{const l=["空闲","运行中","充电中"];t.runningStatus=l[Math.floor(Math.random()*l.length)]}}else t.tasks=[],t.runningStatus="空闲"}else(t.status==="故障"||t.status==="维护中")&&(t.tasks=[],t.runningStatus="停止")})},R=()=>{M.value=!0};return(t,e)=>{const a=X,y=Y,p=nt,x=j,l=Z;return m(),h("div",it,[i(l,{class:"h-full aw-card"},{header:s(()=>[b("div",ot,[e[7]||(e[7]=b("span",{class:"text-lg font-medium"},"AGV状态列表",-1)),b("div",null,[i(a,{type:"primary",onClick:H},{default:s(()=>e[4]||(e[4]=[u("新增")])),_:1}),i(a,{type:"success",onClick:L},{default:s(()=>e[5]||(e[5]=[u("刷新AGV状态")])),_:1}),i(a,{type:"info",onClick:R},{default:s(()=>e[6]||(e[6]=[u("历史记录")])),_:1})])])]),default:s(()=>[i(x,{"row-key":"id",columns:w,data:o(r),"tool-button":!1,pagination:!1},{status:s(({row:n})=>[i(y,{type:B(n.status)},{default:s(()=>[u(_(n.status),1)]),_:2},1032,["type"])]),battery:s(({row:n})=>[i(p,{percentage:n.battery,status:E(n.battery)},null,8,["percentage","status"])]),task:s(({row:n})=>[n.tasks&&n.tasks.length>0?(m(),h("div",rt,[b("div",lt,[(m(!0),h(tt,null,et(n.tasks,d=>(m(),G(y,{key:d.id,type:I(d.priority),class:"task-tag"},{default:s(()=>[u(_(d.name)+" - "+_(d.priority),1)]),_:2},1032,["type"]))),128))])])):(m(),h("span",ut,"无"))]),runningStatus:s(({row:n})=>[i(y,{type:U(n.runningStatus)},{default:s(()=>[u(_(n.runningStatus),1)]),_:2},1032,["type"])]),operation:s(({row:n})=>[b("div",ct,[i(a,{type:"primary",size:"small",onClick:d=>$(n)},{default:s(()=>e[8]||(e[8]=[u("编辑")])),_:2},1032,["onClick"]),i(a,{type:"danger",size:"small",onClick:d=>z(n)},{default:s(()=>e[9]||(e[9]=[u("删除")])),_:2},1032,["onClick"]),i(a,{type:"info",size:"small",onClick:d=>N(n)},{default:s(()=>e[10]||(e[10]=[u("详情")])),_:2},1032,["onClick"]),n.status==="警告"||n.status==="故障"?(m(),G(a,{key:0,type:"warning",size:"small",onClick:d=>D(n)},{default:s(()=>e[11]||(e[11]=[u(" 维护 ")])),_:2},1032,["onClick"])):Q("",!0)])]),_:1},8,["data"])]),_:1}),i(O,{visible:o(g),"onUpdate:visible":e[0]||(e[0]=n=>S(g)?g.value=n:null),"is-edit":o(v),"agv-data":o(V),onSubmit:F},null,8,["visible","is-edit","agv-data"]),i(W,{visible:o(k),"onUpdate:visible":e[1]||(e[1]=n=>S(k)?k.value=n:null),"agv-data":o(C),onCreateMaintenance:D},null,8,["visible","agv-data"]),i(q,{visible:o(A),"onUpdate:visible":e[2]||(e[2]=n=>S(A)?A.value=n:null),"agv-list":o(r),"initial-data":o(T),onSubmit:P},null,8,["visible","agv-list","initial-data"]),i(J,{visible:o(M),"onUpdate:visible":e[3]||(e[3]=n=>S(M)?M.value=n:null),"agv-list":o(r)},null,8,["visible","agv-list"])])}}}),Jt=at(dt,[["__scopeId","data-v-69b0029c"]]);export{Jt as default};
