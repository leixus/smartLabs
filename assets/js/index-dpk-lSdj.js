import{_ as X}from"./index-p7S5r6Wl.js";import{_ as Y}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-D0lzutwe.js";/* empty css             *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                  *//* empty css                     *//* empty css                         *//* empty css                *//* empty css                  *//* empty css                  */import{_ as Z,u as L}from"./useHandleData-DKqFm39K.js";import{d as N,bf as ee,bg as te,p as l,j as oe,bt as re,c as ae,o as h,b as r,a as ne,u as o,bh as $,w as i,aJ as ie,aH as p,bF as m,P as le,E as se,Q as pe,e as g,S as me,i as x,T as ce,t as A,au as ue,bv as _,aj as de,bn as c,bo as fe,V as _e}from"./index-Djyl84eR.js";import{F as u}from"./formEnum-CT3LisML.js";import{T as be}from"./index-BgOfTxXv.js";import{_ as we}from"./index.vue_vue_type_script_setup_true_name_sysUserForm_lang-DiXWc9oW.js";import{_ as he}from"./grantResource.vue_vue_type_script_setup_true_lang-Bq6BNHBk.js";import{_ as ge}from"./grantPermission.vue_vue_type_script_setup_true_lang-DL2UUwfc.js";import"./index-BpMzQZqs.js";/* empty css                  *//* empty css                   *//* empty css                  */import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css               *//* empty css                 *//* empty css                    *//* empty css               *//* empty css                 *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 */import"./sortable.esm-C83syoBY.js";/* empty css                */import"./formRules-BdD8zfEi.js";import"./form_basic-BGYtRUfU.js";import"./index-BImUwXW6.js";import"./el-tab-pane-l0sNRNKZ.js";import"./index.vue_vue_type_script_setup_true_lang-DRw16LSG.js";import"./index.vue_vue_type_script_setup_true_name_SDatePicker_lang-D5yD5oLq.js";/* empty css                       */import"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DgQCsAK8.js";/* empty css                       *//* empty css                        */import"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-BaPcQrZE.js";/* empty css                   */import"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-DO1ZDfLA.js";import"./index.vue_vue_type_script_setup_true_name_SInput_lang-C_fN4iWJ.js";import"./form_more.vue_vue_type_script_setup_true_lang-nABXoP1m.js";import"./index.vue_vue_type_script_setup_true_name_SSelect_lang-CPJJatrh.js";/* empty css                 */import"./dataScopeSelector-q0xw30Ks.js";/* empty css                 */const ve={class:"main-box"},Ee={class:"table-box"},ke=N({name:"SysUser"}),Ct=N({...ke,setup(Se){const B=ee().getDictList(te.COMMON_STATUS),v=l(null),b=l(!1),d=oe({orgId:0}),w=l(),F=[{type:"selection",fixed:"left",width:50},{prop:"searchKey",label:"姓名或账号",search:{el:"input"},isShow:!1},{prop:"avatar",label:"头像",width:80},{prop:"account",label:"账号"},{prop:"name",label:"姓名"},{prop:"gender",label:"性别",width:80},{prop:"phone",label:"手机号"},{prop:"orgName",label:"机构"},{prop:"positionName",label:"职位"},{prop:"status",label:"状态",width:90,enum:B,search:{el:"tree-select"}},{prop:"createTime",label:"创建时间"},{prop:"operation",label:"操作",width:230,fixed:"right"}];function O(e){w.value.pageable.pageNum=1,e!=""?d.orgId=e:d.orgId=0}const E=l(null);function k(e,t={}){var n;(n=E.value)==null||n.onOpen({opt:e,record:t,successful:D})}async function S(e,t){await L(c.delete,{ids:e},t),D()}function D(){var e,t;(e=w.value)==null||e.refresh(),(t=v.value)==null||t.refresh()}let R;(e=>{e.ResetPassword="重置密码",e.GrantRole="授权角色"})(R||(R={}));function C(e,t){return{row:e,command:t}}const y=l(),T=l(0),P=l(null),z=l(null);function U(e){switch(e.command){case"重置密码":L(c.resetPassword,{id:e.row.id},"重置密码");break;case"授权角色":T.value=e.row.id,c.ownRole({id:e.row.id}).then(t=>{var n;(n=y.value)==null||n.showSelector(t.data)});break}}function q(e){const t={id:T.value,roleIdList:e.map(n=>n.id)};c.grantRole(t)}function M(e){b.value=!0;const t=e.status===_.ENABLE?_.DISABLE:_.ENABLE;c.updateStatus({id:e.id},t).then(()=>{_e.success("修改成功"),e.status=t}).finally(()=>{b.value=!1})}return(e,t)=>{const n=Z,V=de,H=ue,j=se,I=ce,G=me,J=le,K=ie,Q=Y,W=X,s=re("auth");return h(),ae("div",ve,[r(be,{ref_key:"treeFilter",ref:v,label:"name",title:"机构列表","show-all":!1,"request-api":o($).tree,"default-value":o(d).orgId,onChange:O},null,8,["request-api","default-value"]),ne("div",Ee,[r(Q,{ref_key:"proTable",ref:w,title:"人员列表",columns:F,"request-api":o(c).page,"init-param":o(d)},{tableHeader:i(a=>[p(r(n,{suffix:"人员",onClick:t[0]||(t[0]=f=>k(o(u).ADD))},null,512),[[s,o(m).add]]),p(r(n,{type:"danger",plain:"",suffix:"人员",opt:o(u).DELETE,disabled:!a.isSelected,onClick:f=>S(a.selectedListIds,"删除所选人员")},null,8,["opt","disabled","onClick"]),[[s,o(m).batchDelete]])]),avatar:i(a=>[r(V,{src:a.row.avatar,size:30},null,8,["src"])]),status:i(a=>[r(H,{"model-value":a.row.status===o(_).ENABLE,loading:o(b),onChange:f=>M(a.row)},null,8,["model-value","loading","onChange"])]),operation:i(a=>[r(K,null,{default:i(()=>[p(r(n,{link:"",opt:o(u).EDIT,onClick:f=>k(o(u).EDIT,a.row)},null,8,["opt","onClick"]),[[s,o(m).edit]]),p(r(n,{link:"",opt:o(u).DELETE,onClick:f=>S([a.row.id],`删除【${a.row.account}】人员`)},null,8,["opt","onClick"]),[[s,o(m).delete]]),r(J,{onCommand:U},{dropdown:i(()=>[r(G,null,{default:i(()=>[p((h(),x(I,{command:C(a.row,"重置密码")},{default:i(()=>[g(A("重置密码"),1)]),_:2},1032,["command"])),[[s,o(m).pwdReset]]),p((h(),x(I,{command:C(a.row,"授权角色")},{default:i(()=>[g(A("授权角色"),1)]),_:2},1032,["command"])),[[s,o(m).grantRole]])]),_:2},1024)]),default:i(()=>[r(j,{type:"primary",underline:!1,icon:o(pe)},{default:i(()=>t[1]||(t[1]=[g(" 更多 ")])),_:1},8,["icon"])]),_:2},1024)]),_:2},1024)]),_:1},8,["request-api","init-param"]),r(we,{ref_key:"formRef",ref:E},null,512),r(W,{ref_key:"roleSelectorRef",ref:y,multiple:"","org-tree-api":o($).tree,"role-selector-api":o(fe).roleSelector,onSuccessful:q},null,8,["org-tree-api","role-selector-api"]),r(he,{user:"",ref_key:"grantResourceRef",ref:P},null,512),r(ge,{user:"",ref_key:"grantPermissionRef",ref:z},null,512)])])}}});export{Ct as default};
