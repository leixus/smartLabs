/* empty css             *//* empty css                *//* empty css                *//* empty css                 *//* empty css                        *//* empty css                  */import"./el-form-item-l0sNRNKZ.js";/* empty css               *//* empty css                  *//* empty css                     *//* empty css                  */import"./index-C6bx8goA.js";import{d as z,j as B,p as E,q as I,aB as M,c as v,o as y,b as t,w as o,_ as L,$ as N,L as O,M as R,K as j,a as d,F as S,r as T,D as $,x as A,u as D,O as K,e as x,am as G,z as H,V as J,ae as Q}from"./index-yDSqlga2.js";import{i as W}from"./install-CPD1cr-Y.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"panel-content grid grid-cols-1 lg:grid-cols-2 gap-4"},Z={class:"chart-container",style:{width:"100%",height:"400px"}},ee=z({__name:"index",setup(te,{expose:k}){const e=B({type:"",startPoint:"",endPoint:"",quantity:1,viaPoints:[]}),m=E([]),c=E();let s=null;const q=()=>{e.viaPoints.push("")},w=r=>{e.viaPoints.splice(r,1)},P=()=>{if(!e.startPoint||!e.endPoint){J.warning("请填写起始位置和目标位置");return}const r=[e.startPoint,...e.viaPoints.filter(a=>a),e.endPoint];m.value.push({type:e.type,path:r,quantity:e.quantity}),V(),e.type="",e.startPoint="",e.endPoint="",e.quantity=1,e.viaPoints=[]},V=()=>{c.value&&Q(()=>{s||(s=W(c.value));const r=new Set,a=[];m.value.forEach(n=>{for(let l=0;l<n.path.length;l++)r.add(n.path[l]),l<n.path.length-1&&a.push({source:n.path[l],target:n.path[l+1],value:n.quantity})});const u={tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"sankey",layout:"none",emphasis:{focus:"adjacency"},data:Array.from(r).map(n=>({name:n})),links:a}]};s.setOption(u)})},g=()=>{s==null||s.resize()};return I(()=>{window.addEventListener("resize",g)}),M(()=>{window.removeEventListener("resize",g),s==null||s.dispose()}),k({materialFlows:m,addMaterialFlow:P,updateMaterialFlowChart:V}),(r,a)=>{const u=R,n=O,l=N,_=j,C=A,f=$,F=G,U=L,h=H;return y(),v("div",Y,[t(h,{class:"h-full"},{header:o(()=>a[4]||(a[4]=[d("div",{class:"card-header"},[d("span",{class:"text-lg font-medium"},"输入物料流动需求")],-1)])),default:o(()=>[t(U,{model:e,"label-width":"100px",class:"w-full"},{default:o(()=>[t(l,{label:"物料类型"},{default:o(()=>[t(n,{modelValue:e.type,"onUpdate:modelValue":a[0]||(a[0]=i=>e.type=i),placeholder:"选择物料类型"},{default:o(()=>[t(u,{label:"试验样品",value:"sample"}),t(u,{label:"设备",value:"equipment"}),t(u,{label:"工具",value:"tool"})]),_:1},8,["modelValue"])]),_:1}),t(l,{label:"起始位置"},{default:o(()=>[t(_,{modelValue:e.startPoint,"onUpdate:modelValue":a[1]||(a[1]=i=>e.startPoint=i)},null,8,["modelValue"])]),_:1}),t(l,{label:"途经点"},{default:o(()=>[d("div",null,[(y(!0),v(S,null,T(e.viaPoints,(i,p)=>(y(),v("div",{class:"flex gap-2 mb-2",key:p},[t(_,{modelValue:e.viaPoints[p],"onUpdate:modelValue":b=>e.viaPoints[p]=b,placeholder:"输入途经点"},null,8,["modelValue","onUpdate:modelValue"]),t(f,{type:"danger",circle:"",onClick:b=>w(p)},{default:o(()=>[t(C,null,{default:o(()=>[t(D(K))]),_:1})]),_:2},1032,["onClick"])]))),128))]),t(f,{type:"primary",plain:"",onClick:q,class:"ml-2"},{default:o(()=>a[5]||(a[5]=[x("添加途经点")])),_:1})]),_:1}),t(l,{label:"目标位置"},{default:o(()=>[t(_,{modelValue:e.endPoint,"onUpdate:modelValue":a[2]||(a[2]=i=>e.endPoint=i)},null,8,["modelValue"])]),_:1}),t(l,{label:"数量"},{default:o(()=>[t(F,{modelValue:e.quantity,"onUpdate:modelValue":a[3]||(a[3]=i=>e.quantity=i),min:1},null,8,["modelValue"])]),_:1}),t(l,null,{default:o(()=>[t(f,{type:"primary",onClick:P},{default:o(()=>a[6]||(a[6]=[x("添加流动需求")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(h,{class:"h-full"},{header:o(()=>a[7]||(a[7]=[d("div",{class:"card-header"},[d("span",{class:"text-lg font-medium"},"物料流动关系图")],-1)])),default:o(()=>[d("div",Z,[d("div",{ref_key:"materialFlowChartRef",ref:c,style:{width:"100%",height:"100%"}},null,512)])]),_:1})])}}}),ye=X(ee,[["__scopeId","data-v-1642d0cf"]]);export{ye as default};
