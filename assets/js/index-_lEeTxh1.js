/* empty css             *//* empty css                  *//* empty css                   *//* empty css               *//* empty css                *//* empty css                  */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import{_ as Y}from"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-CkA160Xq.js";import{_ as Z}from"./index.vue_vue_type_script_setup_true_name_SSelect_lang-Cz-t0Ofh.js";import{d as J,c8 as b,c9 as Q,p as _,j as v,Y as W,b2 as X,a9 as B,c as ee,o as N,b as o,a as p,w as t,i as oe,Z as te,u as i,ca as ne,$ as ae,K as le,x as se,D as de,e as u,t as ie,_ as re,cb as pe,cc as me,I as ue,y as ce,ab as fe,F as _e,cd as E,V as q}from"./index-ClSyKtod.js";import{r as C}from"./formRules-BdD8zfEi.js";import{_ as ve}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                  *//* empty css                   *//* empty css                 */import"./el-tooltip-l0sNRNKZ.js";import"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-DLoTdZhV.js";/* empty css               *//* empty css                  *//* empty css                     */const Ce={class:"flex-y-center w-full"},ge={class:"login-btn"},Ve={class:"flex-y-center w-full"},we=["src"],ye={class:"dialog-footer"},Ie=J({__name:"index",props:{tenantOption:{},tenantOptions:{}},setup(O){var R;const U=b(),k=Q(),{loginPhone:$}=b(),h=O,r=_(!1),a=v({phone:"18652848888",validCode:"",validCodeReqNo:"",tenantId:k.tenantIdGet});k.tenantIdGet||(a.tenantId=(R=h.tenantOptions[0])==null?void 0:R.id);let s=_({time:60,smsSendBtn:!1});const d=v({validCode:"",validCodeReqNo:"",validCodeBase64:""}),x=_(),g=_(),z=v({phone:[C("请输入手机号码")],code:[C("请输入短信验证码")],tenantId:[C("请选择租户")]}),D=v({validCode:[C("请输入验证码")]});W(()=>h.tenantOptions,n=>{n.length>0&&(a.tenantId||(a.tenantId=n[0].id))});const P=n=>{n&&n.validate(async e=>{e&&await $({...a}).catch(async()=>{await V()})})},A=n=>{n&&n.resetFields()};async function G(){await V(),r.value=!0}async function V(){const{data:n}=await E.picCaptcha();n&&(d.validCodeBase64=n.validCodeBase64,d.validCodeReqNo=n.validCodeReqNo)}function T(){var n;(n=x.value)==null||n.validate(async e=>{if(!e)return;r.value=!1,s.value.smsSendBtn=!0;const c=window.setInterval(()=>{s.value.time--<=0&&(s.value.time=60,s.value.smsSendBtn=!1,window.clearInterval(c))},1e3);E.getPhoneValidCode({phone:a.phone,validCode:d.validCode,validCodeReqNo:d.validCodeReqNo}).then(f=>{f.data,a.validCodeReqNo=f.data,r.value=!1,q.success("验证码发送成功")}).catch(()=>{q.error("短信验证码发送失败"),s.value.time=60,s.value.smsSendBtn=!1,window.clearInterval(c)})})}return X(()=>{document.onkeydown=null}),(n,e)=>{const c=Z,f=Y,j=B("Iphone"),w=se,y=le,I=ae,H=B("message"),m=de,F=re,K=B("key"),S=ce,L=ue,M=fe;return N(),ee(_e,null,[o(F,{ref_key:"loginFormRef",ref:g,model:a,rules:z,size:"large"},{default:t(()=>[n.tenantOption==i(ne).CHOSE?(N(),oe(f,{key:0,prop:"orgId",class:"-ml-12px"},{default:t(()=>[o(c,{modelValue:a.tenantId,"onUpdate:modelValue":e[0]||(e[0]=l=>a.tenantId=l),options:n.tenantOptions,label:"name",value:"id",placeholder:"请选择租户"},null,8,["modelValue","options"])]),_:1})):te("",!0),o(I,{prop:"phone"},{default:t(()=>[o(y,{modelValue:a.phone,"onUpdate:modelValue":e[1]||(e[1]=l=>a.phone=l),placeholder:"请输入手机号码"},{prefix:t(()=>[o(w,{class:"el-input__icon"},{default:t(()=>[o(j)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(I,{prop:"validCode"},{default:t(()=>[p("div",Ce,[o(y,{modelValue:a.validCode,"onUpdate:modelValue":e[2]||(e[2]=l=>a.validCode=l),placeholder:"请输入短信验证码"},{prefix:t(()=>[o(w,{class:"el-input__icon"},{default:t(()=>[o(H)]),_:1})]),_:1},8,["modelValue"]),e[8]||(e[8]=p("div",{class:"w-18px"},null,-1)),o(m,{size:"large",onClick:G,disabled:i(s).smsSendBtn},{default:t(()=>[u(ie(!i(s).smsSendBtn&&"获取验证码"||i(s).time+" s"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["model","rules"]),p("div",ge,[o(m,{icon:i(pe),round:"",size:"large",onClick:e[3]||(e[3]=l=>A(g.value))},{default:t(()=>e[9]||(e[9]=[u(" 重置 ")])),_:1},8,["icon"]),o(m,{icon:i(me),round:"",size:"large",type:"primary",loading:i(U).loginLoading,onClick:e[4]||(e[4]=l=>P(g.value))},{default:t(()=>e[10]||(e[10]=[u(" 登录 ")])),_:1},8,["icon","loading"])]),o(M,{modelValue:r.value,"onUpdate:modelValue":e[7]||(e[7]=l=>r.value=l),title:"机器验证",width:"20%","show-close":"","destroy-on-close":""},{footer:t(()=>[p("span",ye,[o(m,{onClick:e[6]||(e[6]=l=>r.value=!1)},{default:t(()=>e[11]||(e[11]=[u("取消")])),_:1}),o(m,{type:"primary",onClick:T},{default:t(()=>e[12]||(e[12]=[u("确定")])),_:1})])]),default:t(()=>[o(F,{ref_key:"captchaFormRef",ref:x,model:d,rules:D,class:"mt-25px",size:"large"},{default:t(()=>[o(L,{gutter:8},{default:t(()=>[o(S,{span:17},{default:t(()=>[o(I,{prop:"validCode"},{default:t(()=>[p("div",Ve,[o(y,{modelValue:d.validCode,"onUpdate:modelValue":e[5]||(e[5]=l=>d.validCode=l),placeholder:"请输入验证码"},{prefix:t(()=>[o(w,{class:"el-input__icon"},{default:t(()=>[o(K)]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),o(S,{span:7},{default:t(()=>[p("img",{src:d.validCodeBase64,onClick:V},null,8,we)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),He=ve(Ie,[["__scopeId","data-v-4d762903"]]);export{He as default};
