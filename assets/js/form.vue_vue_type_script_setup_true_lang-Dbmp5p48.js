import{_ as $}from"./index-C7khZHhV.js";import{_ as N}from"./index-BhKoq_Rb.js";/* empty css             *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                        */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css               *//* empty css                  */import{_ as T}from"./index.vue_vue_type_script_setup_true_name_SRadioGroup_lang-DRblrf2T.js";import{_ as q}from"./index.vue_vue_type_script_setup_true_name_SInput_lang-C8CF6EG3.js";import{_ as j}from"./index.vue_vue_type_script_setup_true_name_SFormItem_lang-CMD2z1PW.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_name_OrgSelector_lang-BiN7E4y6.js";import{d as P,p as c,bf as h,bg as H,j as v,c as L,o as C,b as t,u as r,B as Z,w as n,_ as G,bh as d,i as J,Z as K,D as Q,e as u,g as W,t as X,bm as Y,aH as ee,aI as oe,bn as re,bo as te,bp as le}from"./index-yDSqlga2.js";import{F as S}from"./formEnum-CT3LisML.js";import{r as p}from"./formRules-BdD8zfEi.js";const we=P({__name:"form",setup(se,{expose:y}){const i=c(!1),f=h().getDictList(H.COMMON_STATUS),e=v({opt:S.ADD,record:{},disabled:!1}),I=v({name:[p("请输入机构名称")],parentId:[p("请选择上级机构")],category:[p("请选择机构类型")],status:[p("请选择状态")]});function k(l){Object.assign(e,l),l.opt==S.ADD&&(e.record.sortCode=99,e.record.status=f[0].value),i.value=!0,l.record.id&&d.detail({id:l.record.id}).then(o=>{e.record=o.data})}const _=c();async function w(){var l;(l=_.value)==null||l.validate(async o=>{o&&await d.submitForm(e.record,e.record.id!=null).then(()=>{e.successful()}).finally(()=>{b()})})}function b(){i.value=!1}const g=c();function D(){var o;const l=e.record.directorInfo?[e.record.directorInfo]:[];(o=g.value)==null||o.showSelector(l)}function U(l){l.length>0&&(e.record.directorId=l[0].id,e.record.directorInfo=l[0])}function x(){e.record.directorId=null,e.record.directorInfo=null}return y({onOpen:k}),(l,o)=>{const A=M,a=j,V=q,E=T,m=Q,O=W,z=Y,F=G,R=N,B=$;return C(),L("div",null,[t(R,{modelValue:r(i),"onUpdate:modelValue":o[5]||(o[5]=s=>Z(i)?i.value=s:null),title:`${r(e).opt}机构`,"form-size":"600px"},{footer:n(()=>[t(m,{onClick:b},{default:n(()=>o[7]||(o[7]=[u(" 取消 ")])),_:1}),ee(t(m,{type:"primary",onClick:w},{default:n(()=>o[8]||(o[8]=[u(" 确定 ")])),_:1},512),[[oe,!r(e).disabled]])]),default:n(()=>[t(F,{ref_key:"orgFormRef",ref:_,rules:r(I),disabled:r(e).disabled,model:r(e).record,"hide-required-asterisk":r(e).disabled,"label-width":"auto","label-suffix":" :"},{default:n(()=>[t(a,{label:"上级机构",prop:"parentId"},{default:n(()=>[t(A,{"org-value":r(e).record.parentId,"onUpdate:orgValue":o[0]||(o[0]=s=>r(e).record.parentId=s),"org-tree-api":r(d).tree,"show-all":!1},null,8,["org-value","org-tree-api"])]),_:1}),t(a,{label:"机构名称",prop:"name"},{default:n(()=>[t(V,{modelValue:r(e).record.name,"onUpdate:modelValue":o[1]||(o[1]=s=>r(e).record.name=s)},null,8,["modelValue"])]),_:1}),t(a,{label:"机构编码",prop:"code"},{default:n(()=>[t(V,{modelValue:r(e).record.code,"onUpdate:modelValue":o[2]||(o[2]=s=>r(e).record.code=s),placeholder:"请填写机构编码,不填则为随机值",clearable:""},null,8,["modelValue"])]),_:1}),t(a,{label:"状态",prop:"status"},{default:n(()=>[t(E,{modelValue:r(e).record.status,"onUpdate:modelValue":o[3]||(o[3]=s=>r(e).record.status=s),options:r(f),button:""},null,8,["modelValue","options"])]),_:1}),t(a,{label:"指定主管",prop:"sortCode"},{default:n(()=>[t(m,{link:"",type:"primary",onClick:D},{default:n(()=>o[6]||(o[6]=[u("选择")])),_:1}),r(e).record.directorId?(C(),J(O,{key:0,class:"ml-3px",type:"warning",closable:"",onClose:x},{default:n(()=>{var s;return[u(X((s=r(e).record.directorInfo)==null?void 0:s.name),1)]}),_:1})):K("",!0)]),_:1}),t(a,{label:"排序",prop:"sortCode"},{default:n(()=>[t(z,{modelValue:r(e).record.sortCode,"onUpdate:modelValue":o[4]||(o[4]=s=>r(e).record.sortCode=s),"show-input":"",min:1},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","disabled","model","hide-required-asterisk"])]),_:1},8,["modelValue","title"]),t(B,{ref_key:"userSelectorRef",ref:g,biz:"","org-tree-api":r(d).tree,"position-tree-api":r(le).tree,"role-tree-api":r(te).tree,"user-selector-api":r(re).selector,onSuccessful:U},null,8,["org-tree-api","position-tree-api","role-tree-api","user-selector-api"])])}}});export{we as _};
