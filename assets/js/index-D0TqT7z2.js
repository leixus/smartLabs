/* empty css             *//* empty css                  *//* empty css                */import"./el-form-item-l0sNRNKZ.js";/* empty css                 */import{d as P,c8 as F,c9 as U,p as _,Y as h,j as N,q as z,ce as G,cf as $,cd as K,b2 as T,c as j,F as D,b as n,a as d,_ as H,w as a,D as M,u as v,cb as Y,cc as Z,a9 as g,o as B,i as J,Z as Q,$ as W,K as X,x as ee,e as E}from"./index-Djyl84eR.js";import{s as oe}from"./smCrypto-B1FBs1o4.js";import{r as i}from"./formRules-BdD8zfEi.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"flex-y-center w-full"},ae=["src"],se={class:"login-btn"},le=P({__name:"index",props:{tenantOption:{},tenantOptions:{}},setup(b){var x;const w=F(),C=U(),{loginPwd:O}=F(),r=_(!1),y=_(),k=b;h(()=>k.tenantOptions,e=>{e.length>0&&(t.tenantId||(t.tenantId=e[0].id))});const l=_(),t=N({account:"superAdmin",password:"123456",validCode:"",validCodeReqNo:"",tenantId:C.tenantIdGet});C.tenantIdGet||(t.tenantId=(x=k.tenantOptions[0])==null?void 0:x.id);const A=N({account:[i("请输入用户名")],password:[i("请输入密码")],tenantId:[i("请选择租户")],validCode:[i("请输入验证码")]}),V=e=>{e&&e.validate(async o=>{o&&await O({...t,password:oe.doSm2Encrypt(t.password)}).catch(async()=>{await c()})})},R=e=>{e&&e.resetFields()};z(()=>{document.onkeydown=e=>{if(e=window.event||e,e.code==="Enter"||e.code==="enter"||e.code==="NumpadEnter"){if(w.loginLoading)return;V(l.value)}},G.loginPolicy().then(async e=>{var o;e.data&&(r.value=((o=e.data.find(u=>u.configKey===$.LOGIN_CAPTCHA_OPEN))==null?void 0:o.configValue)==="true",r.value&&await c())})});async function c(){const{data:e}=await K.picCaptcha();e&&(y.value=e.validCodeBase64,t.validCodeReqNo=e.validCodeReqNo)}return T(()=>{document.onkeydown=null}),(e,o)=>{const u=g("user"),p=ee,m=X,f=W,q=g("lock"),S=g("key"),L=H,I=M;return B(),j(D,null,[n(L,{ref_key:"loginFormRef",ref:l,model:t,rules:A,size:"large"},{default:a(()=>[n(f,{prop:"account"},{default:a(()=>[n(m,{modelValue:t.account,"onUpdate:modelValue":o[0]||(o[0]=s=>t.account=s),placeholder:"请输入用户名"},{prefix:a(()=>[n(p,{class:"el-input__icon"},{default:a(()=>[n(u)]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(f,{prop:"password"},{default:a(()=>[n(m,{modelValue:t.password,"onUpdate:modelValue":o[1]||(o[1]=s=>t.password=s),type:"password",placeholder:"请输入密码","show-password":"",autocomplete:"new-password"},{prefix:a(()=>[n(p,{class:"el-input__icon"},{default:a(()=>[n(q)]),_:1})]),_:1},8,["modelValue"])]),_:1}),r.value?(B(),J(f,{key:0,prop:"validCode"},{default:a(()=>[d("div",te,[n(m,{modelValue:t.validCode,"onUpdate:modelValue":o[2]||(o[2]=s=>t.validCode=s),placeholder:"请输入验证码"},{prefix:a(()=>[n(p,{class:"el-input__icon"},{default:a(()=>[n(S)]),_:1})]),_:1},8,["modelValue"]),o[5]||(o[5]=d("div",{class:"w-18px"},null,-1)),d("img",{src:y.value,onClick:c},null,8,ae)])]),_:1})):Q("",!0)]),_:1},8,["model","rules"]),d("div",se,[n(I,{icon:v(Y),round:"",size:"large",onClick:o[3]||(o[3]=s=>R(l.value))},{default:a(()=>o[6]||(o[6]=[E(" 重置 ")])),_:1},8,["icon"]),n(I,{icon:v(Z),round:"",size:"large",type:"primary",loading:v(w).loginLoading,onClick:o[4]||(o[4]=s=>V(l.value))},{default:a(()=>o[7]||(o[7]=[E(" 登录 ")])),_:1},8,["icon","loading"])])],64)}}}),ve=ne(le,[["__scopeId","data-v-8dc9b363"]]);export{ve as default};
